<div class="template-create-container">
  <h2>Créer un nouveau template de package eSIM</h2>
  
  <!-- Messages de succès/erreur -->
  <div class="messages" *ngIf="success || error">
    <div class="alert alert-success" *ngIf="success">
      <i class="fas fa-check-circle"></i>
      {{ success }}
    </div>
    <div class="alert alert-danger" *ngIf="error">
      <i class="fas fa-exclamation-triangle"></i>
      {{ error }}
    </div>
  </div>

  <form [formGroup]="templateForm" (ngSubmit)="onSubmit()" novalidate>
    <div class="form-group">
      <label>Nom du template *</label>
      <input type="text" formControlName="name" />
      <div class="error" *ngIf="f['name'].touched && f['name'].invalid">Nom requis</div>
    </div>

    <div class="form-group">
      <label>Notes</label>
      <textarea formControlName="notes"></textarea>
    </div>

    <div class="form-group">
      <label>Type d'activation *</label>
      <select formControlName="activation_type">
        <option value="MANUAL">Manuelle</option>
        <option value="AUTO">Automatique</option>
      </select>
    </div>

    <div class="form-group">
      <label>Data *</label>
      <div style="display: flex; gap: 8px; align-items: center;">
        <input type="number" formControlName="data_usage_allowance" min="1" style="flex:2;" />
        <select formControlName="data_unit" style="flex:1;">
          <option value="GB">Go</option>
          <option value="MB">Mo</option>
        </select>
      </div>
      <div class="error" *ngIf="f['data_usage_allowance'].touched && f['data_usage_allowance'].invalid">Valeur requise &gt; 0</div>
    </div>

    <div class="form-group">
      <label>Voix (minutes)</label>
      <input type="number" formControlName="voice_usage_allowance" min="0" />
    </div>

    <div class="form-group">
      <label>SMS</label>
      <input type="number" formControlName="sms_usage_allowance" min="0" />
    </div>

    <div class="form-group">
      <label>Validité (secondes) *</label>
      <input type="number" formControlName="activation_time_allowance" min="1" />
      <div class="error" *ngIf="f['activation_time_allowance'].touched && f['activation_time_allowance'].invalid">Valeur requise &gt; 0</div>
    </div>

    <div class="form-group">
      <label>Date d'activation la plus tôt *</label>
      <input type="datetime-local" formControlName="earliest_activation_date" />
      <div class="error" *ngIf="f['earliest_activation_date'].touched && f['earliest_activation_date'].invalid">Date requise</div>
    </div>

    <div class="form-group">
      <label>Date de disponibilité la plus tôt *</label>
      <input type="datetime-local" formControlName="earliest_available_date" />
      <div class="error" *ngIf="f['earliest_available_date'].touched && f['earliest_available_date'].invalid">Date requise</div>
    </div>

    <div class="form-group">
      <label>Date de disponibilité la plus tard *</label>
      <input type="datetime-local" formControlName="latest_available_date" />
      <div class="error" *ngIf="f['latest_available_date'].touched && f['latest_available_date'].invalid">Date requise</div>
    </div>

    <div class="form-group">
      <label>Pays supportés (codes ISO, séparés par virgule, ex: FRA,SEN,DEU)</label>
      <input type="text" formControlName="supported_countries" placeholder="Ex: FRA,SEN,DEU" />
      <div class="error" *ngIf="f['supported_countries'].touched && f['supported_countries'].invalid">Au moins un pays requis</div>
    </div>

    <div class="form-group">
      <label>Validité (unité) *</label>
      <select formControlName="time_allowance_unit">
        <option value="CALENDAR_MONTH">Mois calendaire</option>
        <option value="DAY">Jour</option>
        <option value="HOUR">Heure</option>
      </select>
    </div>

    <div class="form-group">
      <label>Validité (durée) *</label>
      <input type="number" formControlName="time_allowance_duration" min="1" />
      <div class="error" *ngIf="f['time_allowance_duration'].touched && f['time_allowance_duration'].invalid">Durée requise &gt; 0</div>
    </div>

    <!-- Inventory ID et Traffic Policy ID sont masqués/automatiques -->

    <button type="submit" [disabled]="templateForm.invalid || loading">
      <i class="fas fa-spinner fa-spin" *ngIf="loading"></i>
      {{ loading ? 'Création en cours...' : 'Créer le template' }}
    </button>
  </form>
</div>
