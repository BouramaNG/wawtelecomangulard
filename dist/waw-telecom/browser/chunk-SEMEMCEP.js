import{b as Ne,c as T,d as O,e as F,f as X,g as oe,h as V,i as K,j as Z,k as Le,l as Ve,m as G,n as H,o as Y,p as ze,q as $,r as We,s as je,t as z,u as he,v as Q}from"./chunk-4PWVL6TI.js";import{a as qe}from"./chunk-OV6GDISH.js";import{A as xe,a as ie,b as U,d as Ie,h as De,i as Ae,k as Te,n as ye,t as Ee,u as k,w as Fe,x as ae,y as re,z as se}from"./chunk-QXMGU5UO.js";import{Db as i,Eb as u,Fb as _,Gb as W,Hb as ke,Ib as b,Ja as Pe,Jb as v,Kb as M,Mb as P,Na as a,Oa as E,Ob as ge,Pb as J,Sb as D,Tb as Oe,Ub as N,Z as q,_ as ce,a as de,bb as h,ca as R,db as c,eb as we,f as Me,fb as pe,gb as j,ia as S,ja as me,lb as n,m as Se,mb as t,nb as p,rb as y,rc as ue,sa as x,sb as f,sc as L,ta as C,tb as g,tc as w,ua as ne,uc as fe,va as le,wc as B,xc as _e,yc as A}from"./chunk-EPDACEW6.js";var Re=(()=>{class r{static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275cmp=S({type:r,selectors:[["app-dashboard"]],standalone:!0,features:[P],decls:4,vars:0,consts:[[1,"dashboard-layout"]],template:function(s,o){s&1&&(n(0,"div",0),p(1,"app-navig"),n(2,"main"),p(3,"router-outlet"),t()())},dependencies:[Ae,qe]})}}return r})();var Ue=Me(Ee());var be=(()=>{class r{constructor(e,s){this.orderService=e,this.esimService=s,this.esimChoisi=[],this.totalPayments=0}ngOnInit(){this.getPaie(),this.getEsims()}getPaie(){this.orderService.listePaiement().subscribe(e=>{console.log(e),this.commandes=e.payments,console.log(this.commandes),this.totalPayments=this.commandes.reduce((s,o)=>s+parseFloat(o.amount),0)},e=>{console.error("Erreur lors du chargement des paiements:",e)})}getEsims(){this.esimService.listEsim().subscribe(e=>{this.esims=e,this.esimChoisi=this.esims.filter(s=>s.is_assigned==0),console.log(this.esimChoisi)},e=>{console.error("Erreur lors du chargement des eSIMs:",e)})}static{this.\u0275fac=function(s){return new(s||r)(E(xe),E(Q))}}static{this.\u0275cmp=S({type:r,selectors:[["app-stat"]],standalone:!0,features:[P],decls:35,vars:3,consts:[["id","topid",1,"top","row","gap-4"],[1,"card","col-12","col-md-3",2,"width","18rem","color","#333"],[1,"card-body"],[1,"card-title","mb-3",2,"font-size","18px"],[1,"footer"],[1,"fw-bold","fs-4"],["xmlns","http://www.w3.org/2000/svg","width","28","height","28","viewBox","0 0 24 24"],["fill","#333","d","M4 21q-.825 0-1.412-.587T2 19V8q0-.825.588-1.412T4 6h4V4q0-.825.588-1.412T10 2h4q.825 0 1.413.588T16 4v2h4q.825 0 1.413.588T22 8v11q0 .825-.587 1.413T20 21zm6-15h4V4h-4z"],[1,"card","col-12","col-md-3",2,"width","18rem","background-color","#333","color","white"],["xmlns","http://www.w3.org/2000/svg","width","28","height","28","viewBox","0 0 32 32"],["fill","white","d","M29.755 21.345A1 1 0 0 0 29 21h-2v-2c0-1.102-.897-2-2-2h-4c-1.103 0-2 .898-2 2v2h-2a1 1 0 0 0-.99 1.142l1 7A1 1 0 0 0 18 30h10a1 1 0 0 0 .99-.858l1-7a1 1 0 0 0-.235-.797M21 19h4v2h-4zm6.133 9h-8.266l-.714-5h9.694zM10 20h2v10h-2z"],["fill","white","d","m16.78 17.875l-1.906-2.384l-1.442-3.605A2.99 2.99 0 0 0 10.646 10H5c-1.654 0-3 1.346-3 3v7c0 1.103.897 2 2 2h1v8h2V20H4v-7a1 1 0 0 1 1-1h5.646c.411 0 .776.247.928.629l1.645 3.996l2 2.5zM4 5c0-2.206 1.794-4 4-4s4 1.794 4 4s-1.794 4-4 4s-4-1.794-4-4m2 0c0 1.103.897 2 2 2s2-.897 2-2s-.897-2-2-2s-2 .897-2 2"],["xmlns","http://www.w3.org/2000/svg","width","28","height","28","viewBox","0 0 2048 2048"],["fill","#333","d","M1185 1179q-88-75-195-115t-222-40q-88 0-170 23t-153 64t-129 100t-100 130t-65 153t-23 170H0q0-120 35-231t101-205t156-167t204-115q-113-74-176-186t-64-248q0-106 40-199t109-163T568 40T768 0t199 40t163 109t110 163t40 200q0 66-16 129t-48 119t-75 103t-101 83q65 25 124 61t111 81zM384 512q0 80 30 149t82 122t122 83t150 30q79 0 149-30t122-82t83-122t30-150q0-79-30-149t-82-122t-123-83t-149-30q-80 0-149 30t-122 82t-83 123t-30 149m1344 256q66 0 124 25t101 69t69 102t26 124t-25 124t-69 102t-102 69t-124 25q-23 0-45-3l-587 587q-27 27-62 41t-74 15q-40 0-75-15t-61-41t-41-61t-15-75q0-38 14-73t42-63l587-587q-3-22-3-45q0-66 25-124t68-101t102-69t125-26m0 512q40 0 75-15t61-41t41-61t15-75q0-41-19-82l-146 146h-91v-91l146-146q-41-19-82-19q-40 0-75 15t-61 41t-41 61t-15 75q0 41 19 82l-640 641q-19 19-19 45t19 45t45 19t45-19l641-640q41 19 82 19"]],template:function(s,o){s&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),i(4,"Nombre d' "),p(5,"br"),i(6," eSims vendus "),t(),n(7,"div",4)(8,"span",5),ne(),n(9,"svg",6),p(10,"path",7),t(),i(11),t()()()(),le(),n(12,"div",8)(13,"div",2)(14,"h5",3),i(15,"Nombre d' "),p(16,"br"),i(17," eSims disponibles"),t(),n(18,"div",4)(19,"span",5),ne(),n(20,"svg",9),p(21,"path",10)(22,"path",11),t(),i(23),t()()()(),le(),n(24,"div",1)(25,"div",2)(26,"h5",3),i(27," Chiffre d' "),p(28,"br"),i(29," affaire"),t(),n(30,"div",4)(31,"span",5),ne(),n(32,"svg",12),p(33,"path",13),t(),i(34),t()()()()()),s&2&&(a(11),_("\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0 ",o.commandes==null?null:o.commandes.length,""),a(12),_("\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0 ",o.esimChoisi.length,""),a(11),_("\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0",o.totalPayments," XOF"))},styles:["#topid[_ngcontent-%COMP%]{width:80%;margin:2rem auto!important}.card[_ngcontent-%COMP%]{box-shadow:1px .5px 4px #d3d3d3;border:none}@media (max-width:380px){.card[_ngcontent-%COMP%]{font-size:2px!important}}@media (max-width:770px){.top[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:column}.card[_ngcontent-%COMP%]{width:55%!important;height:20%}}@media (max-width:380px){.card[_ngcontent-%COMP%]{width:100%!important}.top[_ngcontent-%COMP%]{width:25vh!important}}@media (min-width:381px) and (max-width:431px){.card[_ngcontent-%COMP%]{width:100%!important}.top[_ngcontent-%COMP%]{width:25vh!important}}@media (min-width:200px) and (max-width:242px){.card[_ngcontent-%COMP%]{width:100%!important;font-size:10px!important}.top[_ngcontent-%COMP%]{width:25vh!important}}"]})}}return r})();var dt=(r,m)=>({itemsPerPage:r,currentPage:m}),ct=(r,m)=>({"badge bg-success":r,"badge bg-danger":m}),mt=r=>({display:r,background:"rgba(0,0,0,0.5)"});function pt(r,m){if(r&1){let e=y();n(0,"tr")(1,"td",39),i(2),t(),n(3,"td"),i(4),t(),n(5,"td"),i(6),t(),n(7,"td"),i(8),D(9,"number"),t(),n(10,"td")(11,"span",40),i(12),t()(),n(13,"td")(14,"span",41),i(15),t()(),n(16,"td"),i(17),D(18,"date"),t(),n(19,"td")(20,"button",42),f("click",function(){let o=x(e).$implicit,d=g();return C(d.openEditModal(o))}),i(21,"Modifier"),t(),n(22,"button",43),f("click",function(){let o=x(e).$implicit,d=g();return C(d.toggleStatus(o))}),i(23),t()()()}if(r&2){let e=m.$implicit;a(2),u(e.name),a(2),u(e.country),a(2),u(e.country_code),a(2),u(N(9,9,e.data_mb,"1.0-0")),a(4),u(e.telna_id),a(2),c("ngClass",J(15,ct,e.status==="active",e.status!=="active")),a(),_(" ",e.status==="active"?"Actif":"Inactif"," "),a(2),u(N(18,12,e.created_at,"short")),a(6),_(" ",e.status==="active"?"D\xE9sactiver":"Activer"," ")}}function gt(r,m){r&1&&(n(0,"div")(1,"p",44),i(2,"\u{1F614} Aucun package eSIM disponible"),t()())}function ut(r,m){if(r&1){let e=y();n(0,"div",45)(1,"div",12)(2,"div",13)(3,"div",14)(4,"h5",46),i(5,"Modifier le package"),t(),n(6,"button",47),f("click",function(){x(e);let o=g();return C(o.closeEditModal())}),t()(),n(7,"div",17)(8,"form",48),f("ngSubmit",function(){x(e);let o=g();return C(o.submitEdit())}),n(9,"div",49)(10,"label",50),i(11,"Nom du package"),t(),n(12,"input",51),M("ngModelChange",function(o){x(e);let d=g();return v(d.packageEdit.name,o)||(d.packageEdit.name=o),C(o)}),t()(),n(13,"div",49)(14,"label",50),i(15,"Pays"),t(),n(16,"input",52),M("ngModelChange",function(o){x(e);let d=g();return v(d.packageEdit.country,o)||(d.packageEdit.country=o),C(o)}),t()(),n(17,"div",49)(18,"label",50),i(19,"Code pays"),t(),n(20,"input",53),M("ngModelChange",function(o){x(e);let d=g();return v(d.packageEdit.country_code,o)||(d.packageEdit.country_code=o),C(o)}),t()(),n(21,"div",49)(22,"label",50),i(23,"Data (Go)"),t(),n(24,"input",54),M("ngModelChange",function(o){x(e);let d=g();return v(d.packageEdit.data_mb,o)||(d.packageEdit.data_mb=o),C(o)}),t()(),n(25,"div",55)(26,"button",56),f("click",function(){x(e);let o=g();return C(o.closeEditModal())}),i(27,"Annuler"),t(),n(28,"button",57),i(29,"Enregistrer"),t()()()()()()()}if(r&2){let e=g();c("ngStyle",ge(5,mt,e.showEditModal?"block":"none")),a(12),b("ngModel",e.packageEdit.name),a(4),b("ngModel",e.packageEdit.country),a(4),b("ngModel",e.packageEdit.country_code),a(4),b("ngModel",e.packageEdit.data_mb)}}var Ge=(()=>{class r{constructor(e,s){this.esimService=e,this.encryptionService=s,this.EsimsPack=[],this.itemsPerPage=6,this.filteredEsims=[],this.page=1,this.packageEdit=null,this.showEditModal=!1}ngOnInit(){let e=JSON.parse(localStorage.getItem("userInfo")||"{}");e&&(this.user=this.encryptionService.decryptData(e),console.log("Forfait d\xE9chiffr\xE9:",this.user)),console.log(this.user),this.getEsimPackageTemplates()}getEsimPackageTemplates(){this.esimService.listEsimPackageTemplates().subscribe(e=>{console.log(e),this.EsimsPack=e.packages,this.filteredEsims=this.EsimsPack})}addPack(){let e={country_code:this.code,country_name:this.name,plan_name:this.plan,price:this.prix,validity_days:Number(this.duree),network_provider:this.net,lpa:this.lpa,esim_identifier:this.esim_ident,image:this.image,network_info:this.net_inf,expiration_policy:this.expolicy,hotspot_allowed:this.hotspot,speed_limit:this.speed};this.esimService.addEsimPackage(e).subscribe(s=>{console.log(s),this.showMessage("success","F\xE9licitations",`${s.message}`)},s=>{if(console.error(s),s.status===422){let o=Object.values(s.error.details).flat().join(`
`);this.showMessage("error","Erreur de validation",o)}else s.status===500?this.showMessage("error","Erreur serveur","Une erreur s'est produite lors de l'ajout du forfait."):this.showMessage("error","Erreur","\xC9chec de l'ajout du forfait eSIM.")})}filterEsims(){this.filteredEsims=this.EsimsPack,this.searchText&&(this.filteredEsims=this.EsimsPack.filter(e=>{let s=this.searchText.toLowerCase();return e.country_name&&e.country_name.toLowerCase().includes(s)||e.plan_name&&e.plan_name.toLowerCase().includes(s)||e.price&&e.price.toString().toLowerCase().includes(s)||e.validity_days&&e.validity_days.toString().toLowerCase().includes(s)}))}getFiles(e){this.selectedFiles=Array.from(e.target.files),console.log(this.selectedFiles)}showMessage(e,s,o){Ue.default.fire({icon:e,title:s,text:o,confirmButtonColor:"var(--couleur)",showConfirmButton:!1,timer:2e3})}archiverPack(e){this.esimService.archivePack(e).subscribe(s=>{console.log(s),this.showMessage("success","F\xE9licitations",`${s.message}`)})}charger(e){this.esimPackageChoisi=e,this.code=this.esimPackageChoisi.country_code,this.name=this.esimPackageChoisi.country_name,this.plan=this.esimPackageChoisi.plan_name,this.prix=this.esimPackageChoisi.price,this.duree=this.esimPackageChoisi.validity_days,this.net=this.esimPackageChoisi.network_provider,this.image=this.esimPackageChoisi.image,this.net_inf=this.esimPackageChoisi.network_info,this.expolicy=this.esimPackageChoisi.expiration_policy,this.hotspot=this.esimPackageChoisi.hotspot_allowed,this.speed=this.esimPackageChoisi.speed_limit}updatePack(){let e={country_code:this.code,country_name:this.name,plan_name:this.plan,price:this.prix,validity_days:Number(this.duree),network_provider:this.net,image:this.image,network_info:this.net_inf,expiration_policy:this.expolicy,hotspot_allowed:this.hotspot,speed_limit:this.speed};this.esimService.updateEsimPackage(this.esimPackageChoisi.id,e).subscribe(s=>{console.log(s),this.showMessage("success","F\xE9licitations",`${s.message}`)},s=>{if(console.error(s),s.status===422){let o=Object.values(s.error.details).flat().join(`
`);this.showMessage("error","Erreur de validation",o)}else s.status===500?this.showMessage("error","Erreur serveur","Une erreur s'est produite lors de la mise \xE0 jour du forfait."):this.showMessage("error","Erreur","\xC9chec de la mise \xE0 jour du forfait eSIM.")})}openEditModal(e){this.packageEdit=de({},e),this.showEditModal=!0}closeEditModal(){this.showEditModal=!1,this.packageEdit=null}submitEdit(){this.packageEdit&&this.esimService.updateEsimPackageTemplate(this.packageEdit.id,this.packageEdit).subscribe(e=>{this.showMessage("success","Succ\xE8s",e.message),this.closeEditModal(),this.getEsimPackageTemplates()},e=>{this.showMessage("error","Erreur","\xC9chec de la modification du package.")})}toggleStatus(e){this.esimService.toggleStatusEsimPackageTemplate(e.id).subscribe(s=>{this.showMessage("success","Succ\xE8s",s.message),this.getEsimPackageTemplates()},s=>{this.showMessage("error","Erreur","Impossible de changer le statut.")})}static{this.\u0275fac=function(s){return new(s||r)(E(Q),E(Fe))}}static{this.\u0275cmp=S({type:r,selectors:[["app-compte"]],standalone:!0,features:[P],decls:108,vars:21,consts:[[1,"text-center"],[1,"search-container","mb-3"],[1,"input-group"],["type","text","name","assi","placeholder","Rechercher par nom, pays, code...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"table-responsive"],[1,"table","table-striped","align-middle","text-center"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"pagination",3,"pageChange"],[4,"ngIf"],["class","modal fade show","tabindex","-1",3,"ngStyle",4,"ngIf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["action",""],[1,"row"],[1,"col","mb-3"],["for","",1,"fw-bold","mb-1"],["type","text","name","country_code","placeholder","Code du pays","aria-label","Code du pays",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","country_name","placeholder","Nom du pays","aria-label","Nom du pays",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","plan_name","placeholder","Nom du plan","aria-label","Nom du plan",1,"form-control",3,"ngModelChange","ngModel"],["type","number","min","0","step","0.01","name","price","placeholder","Prix","aria-label","Prix",1,"form-control",3,"ngModelChange","ngModel"],["type","number","min","1","name","validity_days","placeholder","Validit\xE9 en jours","aria-label","Validit\xE9 en jours",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","network_provider","placeholder","Fournisseur r\xE9seau","aria-label","Fournisseur r\xE9seau",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","image","placeholder","URL de l'image","aria-label","URL de l'image",1,"form-control",3,"ngModelChange","ngModel"],["name","network_info","placeholder","Informations r\xE9seau","aria-label","Informations r\xE9seau",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","expiration_policy","placeholder","Politique d'expiration","aria-label","Politique d'expiration",1,"form-control",3,"ngModelChange","ngModel"],["name","hotspot_allowed","aria-label","Hotspot autoris\xE9",1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","1"],["value","0"],["type","text","name","speed_limit","placeholder","Limite de vitesse","aria-label","Limite de vitesse",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btnAjout",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"fw-bold"],[1,"badge","bg-secondary"],[3,"ngClass"],[1,"btn","btn-primary","btn-sm","me-2",3,"click"],[1,"btn","btn-outline-warning","btn-sm",3,"click"],[1,"text-center","text-danger"],["tabindex","-1",1,"modal","fade","show",3,"ngStyle"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","country","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","country_code","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","data_mb","min","1","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary","me-2",3,"click"],["type","submit",1,"btn","btn-success"]],template:function(s,o){s&1&&(p(0,"app-stat"),n(1,"main")(2,"h2",0),i(3,"Packages eSIM synchronis\xE9s"),t(),n(4,"div",1)(5,"div",2)(6,"input",3),M("ngModelChange",function(l){return v(o.searchText,l)||(o.searchText=l),l}),f("input",function(){return o.filterEsims()}),t()()(),n(7,"div",4)(8,"table",5)(9,"thead",6)(10,"tr")(11,"th"),i(12,"Nom du package"),t(),n(13,"th"),i(14,"Pays"),t(),n(15,"th"),i(16,"Code pays"),t(),n(17,"th"),i(18,"Data (Go)"),t(),n(19,"th"),i(20,"ID Telna"),t(),n(21,"th"),i(22,"Statut"),t(),n(23,"th"),i(24,"Date de cr\xE9ation"),t(),n(25,"th"),i(26,"Actions"),t()()(),n(27,"tbody"),h(28,pt,24,18,"tr",7),D(29,"paginate"),t()(),n(30,"pagination-controls",8),f("pageChange",function(l){return o.page=l}),t(),h(31,gt,3,0,"div",9),t(),h(32,ut,30,7,"div",10),t(),n(33,"div",11)(34,"div",12)(35,"div",13)(36,"div",14)(37,"h1",15),i(38,"Formulaire de modification de package"),t(),p(39,"button",16),t(),n(40,"div",17)(41,"form",18)(42,"div",19)(43,"div",20)(44,"label",21),i(45,"Code du pays :"),t(),n(46,"input",22),M("ngModelChange",function(l){return v(o.code,l)||(o.code=l),l}),t()()(),n(47,"div",19)(48,"div",20)(49,"label",21),i(50,"Nom du pays :"),t(),n(51,"input",23),M("ngModelChange",function(l){return v(o.name,l)||(o.name=l),l}),t()()(),n(52,"div",19)(53,"div",20)(54,"label",21),i(55,"Nom du plan :"),t(),n(56,"input",24),M("ngModelChange",function(l){return v(o.plan,l)||(o.plan=l),l}),t()()(),n(57,"div",19)(58,"div",20)(59,"label",21),i(60,"Prix :"),t(),n(61,"input",25),M("ngModelChange",function(l){return v(o.prix,l)||(o.prix=l),l}),t()()(),n(62,"div",19)(63,"div",20)(64,"label",21),i(65,"Validit\xE9 (jours) :"),t(),n(66,"input",26),M("ngModelChange",function(l){return v(o.duree,l)||(o.duree=l),l}),t()()(),n(67,"div",19)(68,"div",20)(69,"label",21),i(70,"Fournisseur r\xE9seau :"),t(),n(71,"input",27),M("ngModelChange",function(l){return v(o.net,l)||(o.net=l),l}),t()()(),n(72,"div",19)(73,"div",20)(74,"label",21),i(75,"Image (URL) :"),t(),n(76,"input",28),M("ngModelChange",function(l){return v(o.image,l)||(o.image=l),l}),t()()(),n(77,"div",19)(78,"div",20)(79,"label",21),i(80,"Informations r\xE9seau :"),t(),n(81,"textarea",29),M("ngModelChange",function(l){return v(o.net_inf,l)||(o.net_inf=l),l}),t()()(),n(82,"div",19)(83,"div",20)(84,"label",21),i(85,"Politique d'expiration :"),t(),n(86,"input",30),M("ngModelChange",function(l){return v(o.expolicy,l)||(o.expolicy=l),l}),t()()(),n(87,"div",19)(88,"div",20)(89,"label",21),i(90,"Hotspot autoris\xE9 :"),t(),n(91,"select",31),M("ngModelChange",function(l){return v(o.hotspot,l)||(o.hotspot=l),l}),n(92,"option",32),i(93,"S\xE9lectionner..."),t(),n(94,"option",33),i(95,"Oui"),t(),n(96,"option",34),i(97,"Non"),t()()()(),n(98,"div",19)(99,"div",20)(100,"label",21),i(101,"Limite de vitesse :"),t(),n(102,"input",35),M("ngModelChange",function(l){return v(o.speed,l)||(o.speed=l),l}),t()()()()(),n(103,"div",36)(104,"button",37),f("click",function(){return o.updatePack()}),i(105,"Modifier"),t(),n(106,"button",38),i(107,"Annuler"),t()()()()()),s&2&&(a(6),b("ngModel",o.searchText),a(22),c("ngForOf",N(29,15,o.filteredEsims,J(18,dt,o.itemsPerPage,o.page))),a(3),c("ngIf",o.filteredEsims.length==0),a(),c("ngIf",o.showEditModal),a(14),b("ngModel",o.code),a(5),b("ngModel",o.name),a(5),b("ngModel",o.plan),a(5),b("ngModel",o.prix),a(5),b("ngModel",o.duree),a(5),b("ngModel",o.net),a(5),b("ngModel",o.image),a(5),b("ngModel",o.net_inf),a(5),b("ngModel",o.expolicy),a(5),b("ngModel",o.hotspot),a(11),b("ngModel",o.speed))},dependencies:[z,K,H,Y,T,Z,G,F,X,We,$,V,oe,A,ue,L,w,fe,_e,B,se,ae,re,be],styles:["main[_ngcontent-%COMP%]{width:80%;margin:0 auto}.form[_ngcontent-%COMP%]{padding:16px;box-shadow:0 4px 10px #0000001a;margin-bottom:10rem!important}.btnAjout[_ngcontent-%COMP%]{background-color:#fd3;font-weight:700}body[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;background-color:#f4f4f9;margin:0;padding:0}main[_ngcontent-%COMP%]{max-width:1100px;margin:auto;padding:20px}.image[_ngcontent-%COMP%]{width:100%;text-align:center}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:300px;object-fit:cover;border-radius:10px}.titre[_ngcontent-%COMP%]{text-align:center;font-size:26px;font-weight:700;color:#333;margin-top:15px}.cartes[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:15px}.plan-card[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 8px #0000001a;width:30%;max-width:500px;transition:transform .3s ease-in-out}.plan-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.plan-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#333;display:flex;justify-content:space-between;align-items:center}.price[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#f60}.plan-details[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.plan-details[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:16px;color:#555;margin-bottom:5px}.plan-features[_ngcontent-%COMP%]{margin-top:15px}.plan-features[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#444;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #ddd;padding:5px 0}.plan-features[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:18px;color:#007bff}@media (max-width: 768px){.plan-card[_ngcontent-%COMP%]{width:100%}}.btnAjout[_ngcontent-%COMP%]{background-color:#fd3;color:#fff;font-weight:700;float:left}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]})}}return r})();var He=Me(Ee());function ft(r,m){r&1&&(n(0,"div")(1,"p",49),i(2," \u{1F614} Aucun package disponible"),t()())}var Ye=(()=>{class r{constructor(e,s){this.esimService=e,this.route=s}ngOnInit(){this.idEsim=this.route.snapshot.params.id,this.getEsims(),this.listerPack()}getEsims(){this.esimService.listEsim().subscribe(e=>{console.log(e),this.esims=e,console.log(this.esims,"Esim"),this.esimChoisi=this.esims.find(s=>s.id==this.idEsim),console.log(this.esimChoisi,"Esim choisi"),this.idPackage=this.esimChoisi.esim_package_id,console.log(this.idPackage)})}listerPack(){this.esimService.listEsimPackage().subscribe(e=>{console.log(e,"reponse liste pack"),this.esim_package=e,this.esimPackageChoisi=this.esim_package.find(s=>s.id==this.idPackage),console.log(this.esimPackageChoisi)})}charger(){this.code=this.esimPackageChoisi.country_code,this.name=this.esimPackageChoisi.country_name,this.plan=this.esimPackageChoisi.plan_name,this.prix=this.esimPackageChoisi.price,this.duree=this.esimPackageChoisi.validity_days,this.net=this.esimPackageChoisi.network_provider,this.image=this.esimPackageChoisi.image,this.net_inf=this.esimPackageChoisi.network_info,this.expolicy=this.esimPackageChoisi.expiration_policy,this.hotspot=this.esimPackageChoisi.hotspot_allowed,this.speed=this.esimPackageChoisi.speed_limit}updatePack(){let e={country_code:this.code,country_name:this.name,plan_name:this.plan,price:this.prix,validity_days:Number(this.duree),network_provider:this.net,image:this.image,network_info:this.net_inf,expiration_policy:this.expolicy,hotspot_allowed:this.hotspot,speed_limit:this.speed};this.esimService.updateEsimPackage(this.esimChoisi.id,e).subscribe(s=>{console.log(s),this.showMessage("success","F\xE9licitations",`${s.message}`)},s=>{if(console.error(s),s.status===422){let o=Object.values(s.error.details).flat().join(`
`);this.showMessage("error","Erreur de validation",o)}else s.status===500?this.showMessage("error","Erreur serveur","Une erreur s'est produite lors de la mise \xE0 jour du forfait."):this.showMessage("error","Erreur","\xC9chec de la mise \xE0 jour du forfait eSIM.")})}archiverPack(){this.esimService.archivePack(this.esimPackageChoisi.id).subscribe(e=>{console.log(e),this.showMessage("success","F\xE9licitations",`${e.message}`)})}getFiles(e){this.selectedFiles=Array.from(e.target.files),console.log(this.selectedFiles)}showMessage(e,s,o){He.default.fire({icon:e,title:s,text:o,confirmButtonColor:"var(--couleur)",showConfirmButton:!1,timer:2e3})}static{this.\u0275fac=function(s){return new(s||r)(E(Q),E(De))}}static{this.\u0275cmp=S({type:r,selectors:[["app-admin-esim"]],standalone:!0,features:[P],decls:134,vars:25,consts:[[1,"mt-3"],["id","esim",1,""],[1,"image"],["src","https://img.freepik.com/premium-photo/silhouette-high-frequency-5g-station-communication-tower-4g-network-telephone-cellsite-with-dusk-sunset-sky-with-space-text_43300-2298.jpg?ga=GA1.1.522834921.1700648147&semt=ais_hybrid","alt",""],[1,"titre","mt-2"],[1,"cartes","row"],[1,"plan-card","mt-2","ms-2"],[1,"price"],[1,"d-flex","justify-content-between"],[1,"plan-details"],[1,"plan-features"],[1,"icon"],[2,"margin-left","-30vh"],[1,"ms-5"],[2,"margin-left","-27vh"],[2,"margin-left","-20vh"],[2,"margin-left","-23vh"],[1,"bouton"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btnAjout","me-4",3,"click"],[1,"btn","btn-outline-danger",3,"click"],[4,"ngIf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["action",""],[1,"row"],[1,"col","mb-3"],["for","",1,"fw-bold","mb-1"],["type","text","name","country_code","placeholder","Code du pays","aria-label","Code du pays",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","country_name","placeholder","Nom du pays","aria-label","Nom du pays",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","plan_name","placeholder","Nom du plan","aria-label","Nom du plan",1,"form-control",3,"ngModelChange","ngModel"],["type","number","min","0","step","0.01","name","price","placeholder","Prix","aria-label","Prix",1,"form-control",3,"ngModelChange","ngModel"],["type","number","min","1","name","validity_days","placeholder","Validit\xE9 en jours","aria-label","Validit\xE9 en jours",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","network_provider","placeholder","Fournisseur r\xE9seau","aria-label","Fournisseur r\xE9seau",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","image","placeholder","URL de l'image","aria-label","URL de l'image",1,"form-control",3,"ngModelChange","ngModel"],["name","network_info","placeholder","Informations r\xE9seau","aria-label","Informations r\xE9seau",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","expiration_policy","placeholder","Politique d'expiration","aria-label","Politique d'expiration",1,"form-control",3,"ngModelChange","ngModel"],["name","hotspot_allowed","aria-label","Hotspot autoris\xE9",1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","1"],["value","0"],["type","text","name","speed_limit","placeholder","Limite de vitesse","aria-label","Limite de vitesse",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btnAjout",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"text-center","text-danger"]],template:function(s,o){s&1&&(n(0,"main",0)(1,"div",1)(2,"div",2),p(3,"img",3),t(),n(4,"h2",4),i(5),t(),n(6,"div",5)(7,"div",6)(8,"h2"),i(9),n(10,"span",7),i(11),t()(),n(12,"div",8)(13,"ul",9)(14,"li"),i(15,"\u{1F310} N/A"),t(),n(16,"li"),i(17),t()(),n(18,"ul",9)(19,"li"),i(20),t(),n(21,"li"),i(22),t()()(),n(23,"div",10)(24,"p")(25,"span",11),i(26,"\u{1F4F6}"),t(),n(27,"span",12),i(28,"Hotspot"),t(),n(29,"strong",13),i(30),t()(),n(31,"p")(32,"span",11),i(33,"\u26A1"),t(),n(34,"span",14),i(35,"Speed Limit"),t(),n(36,"strong",13),i(37),t()(),n(38,"p")(39,"span",11),i(40,"\u231B"),t(),n(41,"span",15),i(42,"Expiration"),t(),n(43,"strong",13),i(44),t()(),n(45,"p")(46,"span",11),i(47,"\u231A"),t(),n(48,"span",16),i(49,"Cr\xE9e le"),t(),n(50,"strong",13),i(51),D(52,"date"),t()()(),n(53,"div",17)(54,"button",18),f("click",function(){return o.charger()}),i(55,"Modifier"),t(),n(56,"button",19),f("click",function(){return o.archiverPack()}),i(57,"Archiver"),t()()()(),h(58,ft,3,0,"div",20),t()(),n(59,"div",21)(60,"div",22)(61,"div",23)(62,"div",24)(63,"h1",25),i(64,"Formulaire de modification de package"),t(),p(65,"button",26),t(),n(66,"div",27)(67,"form",28)(68,"div",29)(69,"div",30)(70,"label",31),i(71,"Code du pays :"),t(),n(72,"input",32),M("ngModelChange",function(l){return v(o.code,l)||(o.code=l),l}),t()()(),n(73,"div",29)(74,"div",30)(75,"label",31),i(76,"Nom du pays :"),t(),n(77,"input",33),M("ngModelChange",function(l){return v(o.name,l)||(o.name=l),l}),t()()(),n(78,"div",29)(79,"div",30)(80,"label",31),i(81,"Nom du plan :"),t(),n(82,"input",34),M("ngModelChange",function(l){return v(o.plan,l)||(o.plan=l),l}),t()()(),n(83,"div",29)(84,"div",30)(85,"label",31),i(86,"Prix :"),t(),n(87,"input",35),M("ngModelChange",function(l){return v(o.prix,l)||(o.prix=l),l}),t()()(),n(88,"div",29)(89,"div",30)(90,"label",31),i(91,"Validit\xE9 (jours) :"),t(),n(92,"input",36),M("ngModelChange",function(l){return v(o.duree,l)||(o.duree=l),l}),t()()(),n(93,"div",29)(94,"div",30)(95,"label",31),i(96,"Fournisseur r\xE9seau :"),t(),n(97,"input",37),M("ngModelChange",function(l){return v(o.net,l)||(o.net=l),l}),t()()(),n(98,"div",29)(99,"div",30)(100,"label",31),i(101,"Image (URL) :"),t(),n(102,"input",38),M("ngModelChange",function(l){return v(o.image,l)||(o.image=l),l}),t()()(),n(103,"div",29)(104,"div",30)(105,"label",31),i(106,"Informations r\xE9seau :"),t(),n(107,"textarea",39),M("ngModelChange",function(l){return v(o.net_inf,l)||(o.net_inf=l),l}),t()()(),n(108,"div",29)(109,"div",30)(110,"label",31),i(111,"Politique d'expiration :"),t(),n(112,"input",40),M("ngModelChange",function(l){return v(o.expolicy,l)||(o.expolicy=l),l}),t()()(),n(113,"div",29)(114,"div",30)(115,"label",31),i(116,"Hotspot autoris\xE9 :"),t(),n(117,"select",41),M("ngModelChange",function(l){return v(o.hotspot,l)||(o.hotspot=l),l}),n(118,"option",42),i(119,"S\xE9lectionner..."),t(),n(120,"option",43),i(121,"Oui"),t(),n(122,"option",44),i(123,"Non"),t()()()(),n(124,"div",29)(125,"div",30)(126,"label",31),i(127,"Limite de vitesse :"),t(),n(128,"input",45),M("ngModelChange",function(l){return v(o.speed,l)||(o.speed=l),l}),t()()()()(),n(129,"div",46)(130,"button",47),f("click",function(){return o.updatePack()}),i(131,"Modifier"),t(),n(132,"button",48),i(133,"Annuler"),t()()()()()),s&2&&(a(5),_("Packages de ",o.esimPackageChoisi.plan_name," de l' eSim"),a(4),_("",o.esimPackageChoisi.plan_name," "),a(2),_("XOF ",o.esimPackageChoisi.price,""),a(6),_("\u23F3 ",o.esimPackageChoisi.validity_days," jours"),a(3),_("\u{1F517} ",o.esimPackageChoisi.network_provider,""),a(2),W("\u{1F4B3} ",o.esimPackageChoisi.country_name," (",o.esimPackageChoisi.country_code,")"),a(8),u(o.esimPackageChoisi.hotspot_allowed),a(7),u(o.esimPackageChoisi.data_limit),a(7),u(o.esimPackageChoisi.expiration_policy),a(7),u(Oe(52,23,o.esimPackageChoisi.created_at)),a(7),c("ngIf",o.esimPackageChoisi.length==0),a(14),b("ngModel",o.code),a(5),b("ngModel",o.name),a(5),b("ngModel",o.plan),a(5),b("ngModel",o.prix),a(5),b("ngModel",o.duree),a(5),b("ngModel",o.net),a(5),b("ngModel",o.image),a(5),b("ngModel",o.net_inf),a(5),b("ngModel",o.expolicy),a(5),b("ngModel",o.hotspot),a(11),b("ngModel",o.speed))},dependencies:[A,w,B,z,K,H,Y,T,Z,G,F,X,$,V,oe],styles:["body[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;background-color:#f4f4f9;margin:0;padding:0}main[_ngcontent-%COMP%]{max-width:1100px;margin:auto;padding:20px}.image[_ngcontent-%COMP%]{width:100%;text-align:center}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:300px;object-fit:cover;border-radius:10px}.titre[_ngcontent-%COMP%]{text-align:center;font-size:26px;font-weight:700;color:#333;margin-top:15px}.cartes[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:15px;margin:0 auto}.plan-card[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 8px #0000001a;width:90%;max-width:500px;transition:transform .3s ease-in-out}.plan-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.plan-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#333;display:flex;justify-content:space-between;align-items:center}.price[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#f60}.plan-details[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.plan-details[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:16px;color:#555;margin-bottom:5px}.plan-features[_ngcontent-%COMP%]{margin-top:15px}.plan-features[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#444;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #ddd;padding:5px 0}.plan-features[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:18px;color:#007bff}@media (max-width: 768px){.plan-card[_ngcontent-%COMP%]{width:100%}}.btnAjout[_ngcontent-%COMP%]{background-color:#fd3;color:#fff;font-weight:700;float:left}"]})}}return r})();var Qe=Me(Ee());var _t=(r,m)=>({itemsPerPage:r,currentPage:m}),ht=r=>["/admin/admin_eSim",r];function xt(r,m){r&1&&(n(0,"span",45),i(1,"Assign\xE9"),t())}function Ct(r,m){r&1&&(n(0,"span",46),i(1,"Non Assign\xE9"),t())}function bt(r,m){if(r&1){let e=y();n(0,"div",35)(1,"div",36)(2,"h3",37),i(3,"eSIM"),t(),ne(),n(4,"svg",38),p(5,"path",39),t()(),le(),n(6,"p",40)(7,"strong"),i(8,"Code d'activation :"),t(),i(9),t(),n(10,"p")(11,"strong"),i(12,"ICCID :"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Provider :"),t(),i(17),t(),n(18,"p")(19,"strong"),i(20,"LPA :"),t(),i(21),t(),n(22,"p")(23,"strong"),i(24,"Assign\xE9 :"),t(),h(25,xt,2,0,"span",41)(26,Ct,2,0,"span",42),t(),n(27,"p")(28,"strong"),i(29,"Cr\xE9\xE9 le :"),t(),i(30),D(31,"date"),t(),n(32,"p")(33,"strong"),i(34,"Assign\xE9 le :"),t(),i(35),D(36,"date"),t(),n(37,"div",43)(38,"button",44),f("click",function(){let o=x(e).$implicit,d=g();return C(d.archiver(o.id))}),i(39,"Desactiver"),t()()()}if(r&2){let e=m.$implicit;a(4),c("routerLink",ge(15,ht,e.id)),a(5),_(" ",e.activation_code,""),a(4),_(" ",e.iccid,""),a(4),_(" ",e.provider,""),a(4),_(" ",e.lpa,""),a(4),c("ngIf",e.is_assigned===1),a(),c("ngIf",e.is_assigned===0),a(4),_(" ",N(31,9,e.created_at,"dd/MM/yyyy HH:mm"),""),a(5),_(" ",N(36,12,e.assigned_at,"dd/MM/yyyy HH:mm"),"")}}function vt(r,m){r&1&&(n(0,"div")(1,"p",47),i(2," \u{1F614} Aucun esim disponible"),t()())}function Mt(r,m){if(r&1&&(n(0,"option",48),i(1),t()),r&2){let e=m.$implicit;c("value",e.id),a(),W("",e.plan_name," ",e.country_name,"")}}var Je=(()=>{class r{desarchiver(e){}constructor(e){this.esimService=e,this.filteredEsims=[],this.searchText="",this.filterAssigned="all",this.page=1,this.itemsPerPage=6}ngOnInit(){this.getEsim(),this.getEsimPack()}getEsimPack(){this.esimService.listEsimPackage().subscribe(e=>{console.log(e),this.EsimsPack=e})}getEsim(){this.esimService.listEsim().subscribe(e=>{console.log(e),this.Esims=e,console.log(this.Esims),this.filteredEsims=this.Esims})}addEsim(){let e={esim_package_id:this.package_id,activation_code:this.code,sm_dp_address:this.sm_dp_address,country_code:this.c_code,plan_name:this.plan,lpa:this.lpa,is_assigned:!1};this.esimService.addEsim(e).subscribe(s=>{console.log(s),this.showMessage("success","F\xE9licitations",`${s.message}`),this.resetFields()})}charger(e){this.esimChoisi=e,this.code=e.activation_code,this.sm_dp_address=e.sm_dp_address,this.lpa=e.lpa,this.package_id=e.esim_package_id,this.packageChoisi=this.EsimsPack.find(s=>s.id==this.package_id),console.log(this.packageChoisi),this.c_code=this.packageChoisi.country_code,this.plan=this.packageChoisi.plan_name}filterEsims(){if(this.filteredEsims=this.Esims,this.searchText.toLowerCase()==="assigne"){this.filteredEsims=this.filteredEsims.filter(e=>e.is_assigned==1),this.page=1;return}else if(this.searchText.toLowerCase()==="non assigne"){this.filteredEsims=this.filteredEsims.filter(e=>e.is_assigned==0),this.page=1;return}this.searchText&&(this.filteredEsims=this.filteredEsims.filter(e=>{let s=this.searchText.toLowerCase();return e.activation_code&&e.activation_code.toLowerCase().includes(s)||e.lpa&&e.lpa.toLowerCase().includes(s)})),this.page=1}modifierEsim(){let e={esim_package_id:this.package_id,activation_code:this.code,sm_dp_address:this.sm_dp_address,country_code:this.c_code,plan_name:this.plan,lpa:this.lpa,is_assigned:!1};this.esimService.updateEsim(this.esimChoisi.id,e).subscribe(s=>{console.log(s),this.showMessage("success","F\xE9licitations",`${s.message}`),this.Esims,this.resetFields()})}archiver(e){this.esimService.archiverEsim(e).subscribe(s=>{console.log(s),this.showMessage("success","F\xE9licitations",`${s.message}`),this.Esims})}showMessage(e,s,o){Qe.default.fire({icon:e,title:s,text:o,confirmButtonColor:"var(--couleur)",showConfirmButton:!1,timer:2e3})}resetFields(){this.package_id=null,this.code="",this.sm_dp_address="",this.c_code="",this.plan="",this.lpa=""}static{this.\u0275fac=function(s){return new(s||r)(E(Q))}}static{this.\u0275cmp=S({type:r,selectors:[["app-offre"]],standalone:!0,features:[P],decls:60,vars:16,consts:[[1,"mt-3"],["id","esim",1,""],[1,"infos"],[1,"image"],["src","https://img.freepik.com/premium-photo/silhouette-high-frequency-5g-station-communication-tower-4g-network-telephone-cellsite-with-dusk-sunset-sky-with-space-text_43300-2298.jpg?ga=GA1.1.522834921.1700648147&semt=ais_hybrid","alt",""],[1,"info"],[1,"text-center","mt-2"],[1,"search-container","mb-3"],[1,"input-group"],["type","text","name","assi","placeholder","Rechercher par code d'activation, LPA...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"cartes","row"],["class","esim-card m-2",4,"ngFor","ngForOf"],[1,"pagination",3,"pageChange"],[4,"ngIf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["action",""],[1,"row"],[1,"col","mb-3"],["for","",1,"fw-bold","mb-1"],["type","text","name","code","placeholder","Code d'activation","aria-label","Code d'activation",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","code_c","placeholder","Code du pays","aria-label","Code du pays",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","Forfait","placeholder","Forfait","aria-label","forfait",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","sm_dp_address","placeholder","sm_dp_address","aria-label","sm_dp_address",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","lpa","placeholder","lpa","aria-label","lpa",1,"form-control",3,"ngModelChange","ngModel"],["aria-label","Default select example",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btnAjout",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-warning"],[1,"esim-card","m-2"],[1,"header"],[1,"fw-bold"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",3,"routerLink"],["fill","currentColor","d","M4.25 4A2.25 2.25 0 0 0 2 6.25v2.5A2.25 2.25 0 0 0 4.25 11h2.5A2.25 2.25 0 0 0 9 8.75v-2.5A2.25 2.25 0 0 0 6.75 4zM3.5 6.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1-.75-.75zM11.25 5a.75.75 0 0 0 0 1.5h10a.75.75 0 0 0 0-1.5zm0 3a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5zm-7 5A2.25 2.25 0 0 0 2 15.25v2.5A2.25 2.25 0 0 0 4.25 20h2.5A2.25 2.25 0 0 0 9 17.75v-2.5A2.25 2.25 0 0 0 6.75 13zm-.75 2.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1-.75-.75zM11.25 14a.75.75 0 0 0 0 1.5h10a.75.75 0 0 0 0-1.5zm0 3a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5z"],[1,"id"],["class","active",4,"ngIf"],["class","inactive",4,"ngIf"],[1,"bouton"],[1,"btn","btn-danger","fw-bold",3,"click"],[1,"active"],[1,"inactive"],[1,"text-center","text-danger"],[3,"value"]],template:function(s,o){s&1&&(n(0,"main",0)(1,"div",1)(2,"div",2)(3,"div",3),p(4,"img",4),t(),n(5,"div",5)(6,"h2",6),i(7,"liste des eSims"),t(),n(8,"div",7)(9,"div",8)(10,"input",9),M("ngModelChange",function(l){return v(o.searchText,l)||(o.searchText=l),l}),f("input",function(){return o.filterEsims()}),t()(),n(11,"div",10),h(12,bt,40,17,"div",11),D(13,"paginate"),n(14,"pagination-controls",12),f("pageChange",function(l){return o.page=l}),t(),h(15,vt,3,0,"div",13),t()()()(),n(16,"div",14)(17,"div",15)(18,"div",16)(19,"div",17)(20,"h1",18),i(21,"Formulaire de modification d'esim"),t(),p(22,"button",19),t(),n(23,"div",20)(24,"form",21)(25,"div",22)(26,"div",23)(27,"label",24),i(28," Code d'activation :"),t(),n(29,"input",25),M("ngModelChange",function(l){return v(o.code,l)||(o.code=l),l}),t()()(),n(30,"div",22)(31,"div",23)(32,"label",24),i(33," Code du pays :"),t(),n(34,"input",26),M("ngModelChange",function(l){return v(o.c_code,l)||(o.c_code=l),l}),t()()(),n(35,"div",22)(36,"div",23)(37,"label",24),i(38," Forfait :"),t(),n(39,"input",27),M("ngModelChange",function(l){return v(o.plan,l)||(o.plan=l),l}),t()()(),n(40,"div",22)(41,"div",23)(42,"label",24),i(43,"sm_dp_address :"),t(),n(44,"input",28),M("ngModelChange",function(l){return v(o.sm_dp_address,l)||(o.sm_dp_address=l),l}),t()()(),n(45,"div",22)(46,"div",23)(47,"label",24),i(48,"Lpa :"),t(),n(49,"input",29),M("ngModelChange",function(l){return v(o.lpa,l)||(o.lpa=l),l}),t()()(),n(50,"div",23)(51,"label",24),i(52,"Esim Package :"),t(),n(53,"select",30),M("ngModelChange",function(l){return v(o.package_id,l)||(o.package_id=l),l}),h(54,Mt,2,3,"option",31),t()()()(),n(55,"div",32)(56,"button",33),f("click",function(){return o.modifierEsim()}),i(57,"Modifier"),t(),n(58,"button",34),i(59,"Annuler"),t()()()()()()()),s&2&&(a(10),b("ngModel",o.searchText),a(2),c("ngForOf",N(13,10,o.filteredEsims,J(13,_t,o.itemsPerPage,o.page))),a(3),c("ngIf",o.filteredEsims.length==0),a(14),b("ngModel",o.code),a(5),b("ngModel",o.c_code),a(5),b("ngModel",o.plan),a(5),b("ngModel",o.sm_dp_address),a(5),b("ngModel",o.lpa),a(4),b("ngModel",o.package_id),a(),c("ngForOf",o.EsimsPack))},dependencies:[A,L,w,B,Te,se,ae,re,z,K,H,Y,T,G,F,X,V,oe],styles:["#esim[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between;width:90%;margin:0 auto}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:250px;border-radius:1.5%;margin:0 auto}.btnAjout[_ngcontent-%COMP%]{background-color:#fd3;color:#333;font-weight:700;float:left}.esim-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 4px 10px #0000001a;width:360px;font-family:Arial,sans-serif}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.price[_ngcontent-%COMP%]{color:green;font-weight:700}p[_ngcontent-%COMP%]{font-size:14px;margin:5px 0}.id[_ngcontent-%COMP%]{word-break:break-word}.active[_ngcontent-%COMP%]{color:green;font-weight:700}.form[_ngcontent-%COMP%]{padding:16px;box-shadow:0 4px 10px #0000001a}.formcon[_ngcontent-%COMP%]{flex:1;width:40%}.infos[_ngcontent-%COMP%]{flex:1;width:55%}.info[_ngcontent-%COMP%]{display:grid}@media (max-width:912px){#esim[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form[_ngcontent-%COMP%]{margin-top:2rem}}.inactive[_ngcontent-%COMP%]{color:red;font-weight:700}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.cartes[_ngcontent-%COMP%]{width:100%;margin:0 auto}"]})}}return r})();var yt=(r,m)=>({itemsPerPage:r,currentPage:m}),Et=(r,m)=>({display:r,background:m});function St(r,m){r&1&&(n(0,"div",55)(1,"div",56),p(2,"div",57)(3,"div",58)(4,"div",59),t(),n(5,"p"),i(6,"Chargement des commandes..."),t()())}function Pt(r,m){if(r&1&&(n(0,"option",60),i(1),t()),r&2){let e=m.$implicit;c("value",e.value),a(),_(" ",e.label," ")}}function wt(r,m){if(r&1&&(n(0,"option",60),i(1),t()),r&2){let e=m.$implicit;c("value",e.value),a(),_(" ",e.label," ")}}function kt(r,m){if(r&1&&(n(0,"div",61),p(1,"i",62),i(2),t()),r&2){let e=g();a(2),_(" ",e.error," ")}}function Ot(r,m){if(r&1){let e=y();n(0,"tr",63)(1,"td"),i(2),t(),n(3,"td")(4,"div",64)(5,"strong"),i(6),t(),n(7,"small",65),i(8),t()()(),n(9,"td")(10,"div",66)(11,"strong"),i(12),t()()(),n(13,"td")(14,"div",67)(15,"strong"),i(16),t()()(),n(17,"td")(18,"strong",68),i(19),t()(),n(20,"td")(21,"span",69),p(22,"i",70),i(23),t()(),n(24,"td")(25,"code",71),i(26),t()(),n(27,"td")(28,"div",72)(29,"strong"),i(30),t()()(),n(31,"td")(32,"span",73),i(33),t()(),n(34,"td")(35,"span",74),i(36),t()(),n(37,"td")(38,"div",75)(39,"button",76),f("click",function(){let o=x(e).$implicit,d=g();return C(d.voirDetails(o))}),p(40,"i",77),t(),n(41,"button",78),f("click",function(){let o=x(e).$implicit,d=g();return C(d.renvoyerEmail(o))}),p(42,"i",79),t()()()()}if(r&2){let e=m.$implicit,s=m.index,o=g();a(2),u((o.page-1)*o.itemsPerPage+s+1),a(4),u((e.order==null||e.order.user==null?null:e.order.user.name)||"N/A"),a(2),u((e.order==null||e.order.user==null?null:e.order.user.email)||(e.order==null?null:e.order.email)||"N/A"),a(4),u((e.order==null||e.order.esim_package_template==null?null:e.order.esim_package_template.name)||"N/A"),a(4),u((e.order==null||e.order.esim_package_template==null?null:e.order.esim_package_template.country)||"N/A"),a(3),u(o.formaterPrix(e.amount)),a(4),_(" ",e.provider||"N/A"," "),a(3),u(e.transaction_reference||"N/A"),a(4),u((e.order==null||e.order.esim==null?null:e.order.esim.iccid)||"N/A"),a(3),_(" ",o.formaterDate(e.created_at)," "),a(2),c("ngClass",o.getStatutClass(e.payment_status)),a(),_(" ",o.getStatutLabel(e.payment_status)," ")}}function It(r,m){if(r&1){let e=y();n(0,"div",80)(1,"div",3)(2,"div",15)(3,"div",5)(4,"p",8),i(5),t()(),n(6,"div",9)(7,"pagination-controls",81),f("pageChange",function(o){x(e);let d=g();return C(d.page=o)}),t()()()()()}if(r&2){let e=g();a(5),ke(" Affichage ",(e.page-1)*e.itemsPerPage+1," \xE0 ",e.Math.min(e.page*e.itemsPerPage,e.commandesFiltrees.length)," sur ",e.commandesFiltrees.length," commandes ")}}function Dt(r,m){if(r&1){let e=y();n(0,"div",82)(1,"div",83)(2,"div",84),p(3,"i",7),t(),n(4,"h3"),i(5,"Aucune commande trouv\xE9e"),t(),n(6,"p",8),i(7," Aucune commande ne correspond \xE0 vos crit\xE8res de recherche. "),t(),n(8,"button",40),f("click",function(){x(e);let o=g();return C(o.reinitialiserFiltres())}),p(9,"i",85),i(10," R\xE9initialiser les filtres "),t()()()}}function At(r,m){if(r&1){let e=y();n(0,"div",86)(1,"div",87)(2,"div",88)(3,"div",89)(4,"h5",90),p(5,"i",91),i(6," D\xE9tail de la commande "),t(),n(7,"button",92),f("click",function(){x(e);let o=g();return C(o.fermerDetailModal())}),t()(),n(8,"div",93)(9,"div",15)(10,"div",94)(11,"h6",95),i(12,"Informations client"),t(),n(13,"ul",96)(14,"li",97)(15,"strong"),i(16,"Nom :"),t(),i(17),t(),n(18,"li",97)(19,"strong"),i(20,"Email :"),t(),i(21),t(),n(22,"li",97)(23,"strong"),i(24,"T\xE9l\xE9phone :"),t(),i(25),t()()(),n(26,"div",94)(27,"h6",95),i(28,"D\xE9tails de la commande"),t(),n(29,"ul",96)(30,"li",97)(31,"strong"),i(32,"R\xE9f\xE9rence :"),t(),i(33),t(),n(34,"li",97)(35,"strong"),i(36,"Date :"),t(),i(37),D(38,"date"),t(),n(39,"li",97)(40,"strong"),i(41,"Statut :"),t(),i(42),t(),n(43,"li",97)(44,"strong"),i(45,"Montant :"),t(),i(46),t(),n(47,"li",97)(48,"strong"),i(49,"M\xE9thode de paiement :"),t(),i(50),t()()()(),n(51,"div",15)(52,"div",94)(53,"h6",95),i(54,"eSIM achet\xE9e"),t(),n(55,"ul",96)(56,"li",97)(57,"strong"),i(58,"ICCID :"),t(),i(59),t(),n(60,"li",97)(61,"strong"),i(62,"Activation code :"),t(),i(63),t(),n(64,"li",97)(65,"strong"),i(66,"Statut eSIM :"),t(),i(67),t()()(),n(68,"div",94)(69,"h6",95),i(70,"Forfait eSIM"),t(),n(71,"ul",96)(72,"li",97)(73,"strong"),i(74,"Plan :"),t(),i(75),t(),n(76,"li",97)(77,"strong"),i(78,"Pays :"),t(),i(79),t(),n(80,"li",97)(81,"strong"),i(82,"Code pays :"),t(),i(83),t(),n(84,"li",97)(85,"strong"),i(86,"Data :"),t(),i(87),t(),n(88,"li",97)(89,"strong"),i(90,"Statut :"),t(),i(91),t()()()()(),n(92,"div",98)(93,"button",99),f("click",function(){x(e);let o=g();return C(o.fermerDetailModal())}),i(94,"Fermer"),t()()()()()}if(r&2){let e=g();c("ngStyle",J(20,Et,e.showDetailModal?"block":"none",e.showDetailModal?"rgba(0,0,0,0.5)":"none")),a(17),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.user==null?null:e.selectedCommande.order.user.name)||"N/A",""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.user==null?null:e.selectedCommande.order.user.email)||(e.selectedCommande==null||e.selectedCommande.order==null?null:e.selectedCommande.order.email)||"N/A",""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.user==null?null:e.selectedCommande.order.user.phone)||(e.selectedCommande==null||e.selectedCommande.order==null?null:e.selectedCommande.order.phone_number)||"N/A",""),a(8),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null?null:e.selectedCommande.order.ref_command)||"N/A",""),a(4),_(" ",N(38,17,e.selectedCommande==null||e.selectedCommande.order==null?null:e.selectedCommande.order.created_at,"medium"),""),a(5),_(" ",e.getStatutLabel((e.selectedCommande==null?null:e.selectedCommande.payment_status)||""),""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null?null:e.selectedCommande.order.amount)||(e.selectedCommande==null?null:e.selectedCommande.amount)||0," XOF"),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null?null:e.selectedCommande.order.payment_method)||"N/A",""),a(9),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim==null?null:e.selectedCommande.order.esim.iccid)||"N/A",""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim==null?null:e.selectedCommande.order.esim.activation_code)||"N/A",""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim==null?null:e.selectedCommande.order.esim.status)||"N/A",""),a(8),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim_package_template==null?null:e.selectedCommande.order.esim_package_template.name)||"N/A",""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim_package_template==null?null:e.selectedCommande.order.esim_package_template.country)||"N/A",""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim_package_template==null?null:e.selectedCommande.order.esim_package_template.country_code)||"N/A",""),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim_package_template==null?null:e.selectedCommande.order.esim_package_template.data_mb)||"N/A"," Mo"),a(4),_(" ",(e.selectedCommande==null||e.selectedCommande.order==null||e.selectedCommande.order.esim_package_template==null?null:e.selectedCommande.order.esim_package_template.status)||"N/A","")}}var Xe=(()=>{class r{constructor(e){this.orderService=e,this.destroy$=new Se,this.commandes=[],this.commandesFiltrees=[],this.page=1,this.itemsPerPage=10,this.recherche="",this.filtreStatut="",this.filtreDate="",this.filtrePays="",this.statistiques={totalCommandes:0,commandesAujourdhui:0,revenusTotal:0,revenusAujourdhui:0,tauxReussite:0},this.loading=!1,this.error="",this.statuts=[{value:"",label:"Tous les statuts"},{value:"success",label:"R\xE9ussi"},{value:"echec",label:"\xC9chec"},{value:"Annul\xE9e",label:"Annul\xE9e"}],this.pays=[{value:"",label:"Tous les pays"},{value:"France",label:"France"},{value:"Maroc",label:"Maroc"},{value:"S\xE9n\xE9gal",label:"S\xE9n\xE9gal"}],this.selectedCommande=null,this.showDetailModal=!1}ngOnInit(){this.chargerCommandes(),this.setupRecherche()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupRecherche(){}chargerCommandes(){this.loading=!0,this.error="",this.orderService.listePaiement().subscribe({next:e=>{this.commandes=e.payments||[],this.commandesFiltrees=[...this.commandes],this.calculerStatistiques(),this.loading=!1},error:e=>{this.error="Erreur lors du chargement des commandes",this.loading=!1,console.error("Erreur chargement commandes:",e)}})}appliquerFiltres(){this.commandesFiltrees=this.commandes.filter(e=>{let s=!this.recherche||e.order?.user?.name?.toLowerCase().includes(this.recherche.toLowerCase())||e.order?.user?.email?.toLowerCase().includes(this.recherche.toLowerCase())||e.transaction_reference?.toLowerCase().includes(this.recherche.toLowerCase()),o=!this.filtreStatut||e.payment_status===this.filtreStatut,d=!this.filtrePays||e.order?.esim_package?.country_name===this.filtrePays;return s&&o&&d}),this.page=1,this.calculerStatistiques()}reinitialiserFiltres(){this.recherche="",this.filtreStatut="",this.filtreDate="",this.filtrePays="",this.appliquerFiltres()}calculerStatistiques(){let e=new Date().toDateString();this.statistiques={totalCommandes:this.commandesFiltrees.length,commandesAujourdhui:this.commandesFiltrees.filter(s=>new Date(s.created_at).toDateString()===e).length,revenusTotal:this.commandesFiltrees.reduce((s,o)=>s+(Number(o.amount)||Number(o.order?.amount)||0),0),revenusAujourdhui:this.commandesFiltrees.filter(s=>new Date(s.created_at).toDateString()===e).reduce((s,o)=>s+(Number(o.amount)||Number(o.order?.amount)||0),0),tauxReussite:this.commandesFiltrees.length>0?this.commandesFiltrees.filter(s=>s.payment_status==="success").length/this.commandesFiltrees.length*100:0}}getStatutClass(e){switch(e?.toLowerCase()){case"success":return"badge-success";case"echec":return"badge-danger";case"annul\xE9e":return"badge-warning";default:return"badge-secondary"}}getStatutLabel(e){switch(e?.toLowerCase()){case"success":return"R\xE9ussi";case"echec":return"\xC9chec";case"annul\xE9e":return"Annul\xE9e";default:return e||"Inconnu"}}formaterPrix(e){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(e)}formaterDate(e){return new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}voirDetails(e){console.log("D\xE9tail s\xE9lectionn\xE9:",e),console.log("Order:",e.order),console.log("eSIM:",e.order?.esim),console.log("Template:",e.order?.esim_package_template),this.selectedCommande=e,this.showDetailModal=!0}fermerDetailModal(){this.showDetailModal=!1,this.selectedCommande=null}renvoyerEmail(e){console.log("Renvoyer email pour:",e)}exporterDonnees(){console.log("Export des donn\xE9es")}get Math(){return Math}static{this.\u0275fac=function(s){return new(s||r)(E(xe))}}static{this.\u0275cmp=S({type:r,selectors:[["app-commande"]],standalone:!0,features:[P],decls:139,vars:27,consts:[["class","loading-overlay",4,"ngIf"],[1,"admin-commandes"],[1,"header-section"],[1,"container-fluid"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"page-title"],[1,"fas","fa-shopping-cart"],[1,"text-muted"],[1,"col-md-6","text-end"],[1,"btn","btn-primary","me-2",3,"click"],[1,"fas","fa-download"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-sync-alt"],[1,"stats-section"],[1,"row"],[1,"col-md-2","col-sm-6","mb-3"],[1,"stat-card"],[1,"stat-icon","bg-primary"],[1,"stat-content"],[1,"stat-icon","bg-success"],[1,"fas","fa-calendar-day"],[1,"stat-icon","bg-info"],[1,"fas","fa-money-bill-wave"],[1,"stat-icon","bg-warning"],[1,"fas","fa-chart-line"],[1,"fas","fa-percentage"],[1,"filters-section"],[1,"card"],[1,"card-body"],[1,"col-md-3","mb-3"],[1,"form-label"],["type","text","placeholder","Client, email, r\xE9f\xE9rence...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"col-md-2","mb-3"],[1,"form-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-md-3","mb-3","d-flex","align-items-end"],[1,"btn","btn-outline-secondary","me-2",3,"click"],[1,"fas","fa-times"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],["class","alert alert-danger",4,"ngIf"],[1,"table-section"],[1,"card-header"],[1,"mb-0"],[1,"fas","fa-list"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-dark"],["class","commande-row",4,"ngFor","ngForOf"],["class","pagination-section",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","modal fade show","tabindex","-1",3,"ngStyle",4,"ngIf"],[1,"loading-overlay"],[1,"spinner"],[1,"bounce1"],[1,"bounce2"],[1,"bounce3"],[3,"value"],[1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle"],[1,"commande-row"],[1,"client-info"],[1,"text-muted","d-block"],[1,"product-info"],[1,"country-info"],[1,"text-success"],[1,"payment-method"],[1,"fas","fa-credit-card"],[1,"reference-code"],[1,"iccid-info"],[1,"date-info"],[1,"badge",3,"ngClass"],[1,"action-buttons"],["title","Voir d\xE9tails",1,"btn","btn-sm","btn-outline-primary","me-1",3,"click"],[1,"fas","fa-eye"],["title","Renvoyer email",1,"btn","btn-sm","btn-outline-success","me-1",3,"click"],[1,"fas","fa-envelope"],[1,"pagination-section"],[1,"pagination-custom",3,"pageChange"],[1,"empty-state"],[1,"container-fluid","text-center"],[1,"empty-icon"],[1,"fas","fa-refresh"],["tabindex","-1",1,"modal","fade","show",3,"ngStyle"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-info-circle"],["type","button","aria-label","Fermer",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-md-6","mb-3"],[1,"fw-bold","mb-2"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(s,o){s&1&&(p(0,"app-stat"),h(1,St,7,0,"div",0),n(2,"main",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h1",6),p(8,"i",7),i(9," Gestion des Commandes "),t(),n(10,"p",8),i(11,"Suivi et gestion de toutes les commandes eSIM"),t()(),n(12,"div",9)(13,"button",10),f("click",function(){return o.exporterDonnees()}),p(14,"i",11),i(15," Exporter "),t(),n(16,"button",12),f("click",function(){return o.chargerCommandes()}),p(17,"i",13),i(18," Actualiser "),t()()()()(),n(19,"div",14)(20,"div",3)(21,"div",15)(22,"div",16)(23,"div",17)(24,"div",18),p(25,"i",7),t(),n(26,"div",19)(27,"h3"),i(28),t(),n(29,"p"),i(30,"Total Commandes"),t()()()(),n(31,"div",16)(32,"div",17)(33,"div",20),p(34,"i",21),t(),n(35,"div",19)(36,"h3"),i(37),t(),n(38,"p"),i(39,"Aujourd'hui"),t()()()(),n(40,"div",16)(41,"div",17)(42,"div",22),p(43,"i",23),t(),n(44,"div",19)(45,"h3"),i(46),t(),n(47,"p"),i(48,"Revenus Total"),t()()()(),n(49,"div",16)(50,"div",17)(51,"div",24),p(52,"i",25),t(),n(53,"div",19)(54,"h3"),i(55),t(),n(56,"p"),i(57,"Revenus Aujourd'hui"),t()()()(),n(58,"div",16)(59,"div",17)(60,"div",20),p(61,"i",26),t(),n(62,"div",19)(63,"h3"),i(64),D(65,"number"),t(),n(66,"p"),i(67,"Taux de R\xE9ussite"),t()()()()()()(),n(68,"div",27)(69,"div",3)(70,"div",28)(71,"div",29)(72,"div",15)(73,"div",30)(74,"label",31),i(75,"\u{1F50D} Recherche"),t(),n(76,"input",32),M("ngModelChange",function(l){return v(o.recherche,l)||(o.recherche=l),l}),f("input",function(){return o.appliquerFiltres()}),t()(),n(77,"div",33)(78,"label",31),i(79,"\u{1F4CA} Statut"),t(),n(80,"select",34),M("ngModelChange",function(l){return v(o.filtreStatut,l)||(o.filtreStatut=l),l}),f("change",function(){return o.appliquerFiltres()}),h(81,Pt,2,2,"option",35),t()(),n(82,"div",33)(83,"label",31),i(84,"\u{1F30D} Pays"),t(),n(85,"select",34),M("ngModelChange",function(l){return v(o.filtrePays,l)||(o.filtrePays=l),l}),f("change",function(){return o.appliquerFiltres()}),h(86,wt,2,2,"option",35),t()(),n(87,"div",33)(88,"label",31),i(89,"\u{1F4C5} Date"),t(),n(90,"input",36),M("ngModelChange",function(l){return v(o.filtreDate,l)||(o.filtreDate=l),l}),f("change",function(){return o.appliquerFiltres()}),t()(),n(91,"div",37)(92,"button",38),f("click",function(){return o.reinitialiserFiltres()}),p(93,"i",39),i(94," R\xE9initialiser "),t(),n(95,"button",40),f("click",function(){return o.appliquerFiltres()}),p(96,"i",41),i(97," Filtrer "),t()()()()()()(),h(98,kt,3,1,"div",42),n(99,"div",43)(100,"div",3)(101,"div",28)(102,"div",44)(103,"h5",45),p(104,"i",46),i(105),t()(),n(106,"div",47)(107,"div",48)(108,"table",49)(109,"thead",50)(110,"tr")(111,"th"),i(112,"#"),t(),n(113,"th"),i(114,"\u{1F464} Client"),t(),n(115,"th"),i(116,"\u{1F4F1} Produit"),t(),n(117,"th"),i(118,"\u{1F30D} Pays"),t(),n(119,"th"),i(120,"\u{1F4B0} Prix"),t(),n(121,"th"),i(122,"\u{1F4B3} Paiement"),t(),n(123,"th"),i(124,"\u{1F517} R\xE9f\xE9rence"),t(),n(125,"th"),i(126,"\u{1F4CB} ICCID"),t(),n(127,"th"),i(128,"\u{1F4C5} Date"),t(),n(129,"th"),i(130,"\u{1F4CA} Statut"),t(),n(131,"th"),i(132,"\u2699\uFE0F Actions"),t()()(),n(133,"tbody"),h(134,Ot,43,12,"tr",51),D(135,"paginate"),t()()()()()()(),h(136,It,8,3,"div",52)(137,Dt,11,0,"div",53)(138,At,95,23,"div",54),t()),s&2&&(a(),c("ngIf",o.loading),a(27),u(o.statistiques.totalCommandes),a(9),u(o.statistiques.commandesAujourdhui),a(9),u(o.formaterPrix(o.statistiques.revenusTotal)),a(9),u(o.formaterPrix(o.statistiques.revenusAujourdhui)),a(9),_("",N(65,18,o.statistiques.tauxReussite,"1.0-1"),"%"),a(12),b("ngModel",o.recherche),a(4),b("ngModel",o.filtreStatut),a(),c("ngForOf",o.statuts),a(4),b("ngModel",o.filtrePays),a(),c("ngForOf",o.pays),a(4),b("ngModel",o.filtreDate),a(8),c("ngIf",o.error),a(7),_(" Liste des Commandes (",o.commandesFiltrees.length," r\xE9sultats) "),a(29),c("ngForOf",N(135,21,o.commandesFiltrees,J(24,yt,o.itemsPerPage,o.page))),a(2),c("ngIf",o.commandesFiltrees.length>0),a(),c("ngIf",o.commandesFiltrees.length===0&&!o.loading),a(),c("ngIf",o.showDetailModal))},dependencies:[A,ue,L,w,fe,_e,B,se,ae,re,be,z,H,Y,T,G,F,V,he],styles:[".admin-commandes[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px 0}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;color:#fff}.spinner[_ngcontent-%COMP%]{display:flex;margin-bottom:20px}.spinner[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:18px;height:18px;background-color:#fff;border-radius:100%;display:inline-block;animation:_ngcontent-%COMP%_bounce 1.4s infinite ease-in-out both;margin:0 3px}.spinner[_ngcontent-%COMP%]   .bounce1[_ngcontent-%COMP%]{animation-delay:-.32s}.spinner[_ngcontent-%COMP%]   .bounce2[_ngcontent-%COMP%]{animation-delay:-.16s}@keyframes _ngcontent-%COMP%_bounce{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}.header-section[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;padding:30px;margin-bottom:30px;box-shadow:0 8px 32px #0000001a;animation:_ngcontent-%COMP%_slideInDown .6s ease-out}.page-title[_ngcontent-%COMP%]{color:#2c3e50;font-weight:700;font-size:2.5rem;margin-bottom:10px;display:flex;align-items:center;gap:15px}.page-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea;font-size:2rem}.stats-section[_ngcontent-%COMP%]{margin-bottom:30px;animation:_ngcontent-%COMP%_slideInUp .6s ease-out .2s both}.stat-card[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;padding:25px;box-shadow:0 8px 32px #0000001a;transition:all .3s ease;border:1px solid rgba(255,255,255,.2);display:flex;align-items:center;gap:20px}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 15px 40px #00000026}.stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:#fff;flex-shrink:0}.stat-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0;color:#2c3e50}.stat-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#7f8c8d;font-size:.9rem}.filters-section[_ngcontent-%COMP%]{margin-bottom:30px;animation:_ngcontent-%COMP%_slideInUp .6s ease-out .4s both}.filters-section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 32px #0000001a}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50;margin-bottom:8px}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:10px;border:2px solid #e9ecef;transition:all .3s ease;padding:12px 15px}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 0 .2rem #667eea40}.table-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out .6s both}.table-section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 32px #0000001a;overflow:hidden}.table-section[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;padding:20px 25px}.table-section[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-weight:600;display:flex;align-items:center;gap:10px}.table[_ngcontent-%COMP%]{margin:0}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#2c3e50;color:#fff;border:none;padding:15px 12px;font-weight:600;font-size:.9rem;text-transform:uppercase;letter-spacing:.5px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .3s ease;border-bottom:1px solid #f8f9fa}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#667eea0d;transform:scale(1.01)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:15px 12px;vertical-align:middle;border:none}.client-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600}.client-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.8rem}.product-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600}.product-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.8rem}.country-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:5px 12px;border-radius:20px;font-size:.8rem;font-weight:500}.iccid-badge[_ngcontent-%COMP%]{background:#f8f9fa;color:#6c757d;padding:5px 10px;border-radius:8px;font-family:Courier New,monospace;font-size:.8rem;border:1px solid #e9ecef}.payment-method[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#6c757d;font-size:.9rem}.payment-method[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea}.reference-code[_ngcontent-%COMP%]{background:#f8f9fa;color:#6c757d;padding:3px 8px;border-radius:5px;font-size:.8rem;border:1px solid #e9ecef}.date-info[_ngcontent-%COMP%]{color:#6c757d;font-size:.9rem}.badge[_ngcontent-%COMP%]{padding:8px 12px;border-radius:20px;font-weight:500;font-size:.8rem;text-transform:uppercase;letter-spacing:.5px}.badge-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);color:#fff}.badge-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc3545,#fd7e14);color:#fff}.badge-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffc107,#fd7e14);color:#212529}.badge-secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6c757d,#495057);color:#fff}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:5px}.action-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:8px;padding:6px 10px;font-size:.8rem;transition:all .3s ease}.action-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 5px 15px #0003}.pagination-section[_ngcontent-%COMP%]{margin-top:30px;animation:_ngcontent-%COMP%_slideInUp .6s ease-out .8s both}.pagination-custom[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:5px}.pagination-custom[_ngcontent-%COMP%]   .ngx-pagination[_ngcontent-%COMP%]{display:flex;gap:5px;list-style:none;margin:0;padding:0}.pagination-custom[_ngcontent-%COMP%]   .ngx-pagination[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:0}.pagination-custom[_ngcontent-%COMP%]   .ngx-pagination[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .pagination-custom[_ngcontent-%COMP%]   .ngx-pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);color:#2c3e50;padding:10px 15px;border-radius:8px;text-decoration:none;transition:all .3s ease;font-weight:500}.pagination-custom[_ngcontent-%COMP%]   .ngx-pagination[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .pagination-custom[_ngcontent-%COMP%]   .ngx-pagination[_ngcontent-%COMP%]   span.current[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;transform:translateY(-2px);box-shadow:0 5px 15px #0003}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;animation:_ngcontent-%COMP%_slideInUp .6s ease-out 1s both}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;color:#bdc3c7;margin-bottom:20px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin-bottom:30px}@keyframes _ngcontent-%COMP%_slideInDown{0%{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.admin-commandes[_ngcontent-%COMP%]{padding:10px 0}.header-section[_ngcontent-%COMP%]{padding:20px;margin-bottom:20px}.page-title[_ngcontent-%COMP%]{font-size:2rem}.stat-card[_ngcontent-%COMP%]{padding:20px;margin-bottom:15px}.stat-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem}.table-responsive[_ngcontent-%COMP%]{font-size:.8rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 8px}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:3px}}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,#5a6fd8,#6a4190)}.text-success[_ngcontent-%COMP%]{color:#28a745!important}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.bg-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)!important}.bg-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997)!important}.bg-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#17a2b8,#20c997)!important}.bg-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffc107,#fd7e14)!important}.btn[_ngcontent-%COMP%]{transition:all .3s ease;border-radius:8px;font-weight:500}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 5px 15px #0003}.card[_ngcontent-%COMP%]{transition:all .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 30px #00000026}"]})}}return r})();var Ke=(()=>{class r{constructor(e){this.http=e}triggerSync(e=50,s=!1){let o=localStorage.getItem("token"),d={limit:e,packages:s};return this.http.post(`${k}console-connect/sync`,d,{headers:new ie({Authorization:`Bearer ${o}`})})}getSyncStatus(){let e=localStorage.getItem("token");return this.http.get(`${k}console-connect/status`,{headers:new ie({Authorization:`Bearer ${e}`})})}getSyncLogs(){let e=localStorage.getItem("token");return this.http.get(`${k}console-connect/logs`,{headers:new ie({Authorization:`Bearer ${e}`})})}testConnection(){let e=localStorage.getItem("token");return this.http.get(`${k}console-connect/test`,{headers:new ie({Authorization:`Bearer ${e}`})})}getSyncStats(){let e=localStorage.getItem("token");return this.http.get(`${k}console-connect/stats`,{headers:new ie({Authorization:`Bearer ${e}`})})}static{this.\u0275fac=function(s){return new(s||r)(R(U))}}static{this.\u0275prov=q({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Ft(r,m){r&1&&(n(0,"div",24),p(1,"div",25),n(2,"p"),i(3,"Synchronisation en cours..."),t()())}function Nt(r,m){if(r&1&&(n(0,"div",26)(1,"div",27),i(2),t(),n(3,"div",28),i(4),t()()),r&2){let e=m.$implicit;a(2),u(e.timestamp),a(),j(e.level),a(),_(" ",e.message," ")}}function Lt(r,m){r&1&&(n(0,"div",29),i(1," Aucun log disponible "),t())}var Ze=(()=>{class r{constructor(e){this.consoleConnectService=e,this.syncStatus={},this.syncLogs=[],this.syncStats={},this.isLoading=!1,this.syncInProgress=!1}ngOnInit(){this.loadSyncStatus(),this.loadSyncStats()}loadSyncStatus(){this.isLoading=!0,this.consoleConnectService.getSyncStatus().subscribe({next:e=>{this.syncStatus=e,this.isLoading=!1},error:e=>{console.error("Erreur chargement statut:",e),this.isLoading=!1}})}loadSyncStats(){this.consoleConnectService.getSyncStats().subscribe({next:e=>{this.syncStats=e},error:e=>{console.error("Erreur chargement stats:",e)}})}triggerSync(e=50,s=!1){this.syncInProgress=!0,this.consoleConnectService.triggerSync(e,s).subscribe({next:o=>{console.log("Synchronisation d\xE9clench\xE9e:",o),this.syncInProgress=!1,this.loadSyncStatus(),this.loadSyncLogs()},error:o=>{console.error("Erreur synchronisation:",o),this.syncInProgress=!1}})}loadSyncLogs(){this.consoleConnectService.getSyncLogs().subscribe({next:e=>{this.syncLogs=e.logs||[]},error:e=>{console.error("Erreur chargement logs:",e)}})}testConnection(){this.isLoading=!0,this.consoleConnectService.testConnection().subscribe({next:e=>{console.log("Test connexion:",e),this.isLoading=!1},error:e=>{console.error("Erreur test connexion:",e),this.isLoading=!1}})}quickSync(){this.triggerSync(50,!1)}fullSync(){this.triggerSync(100,!0)}testSync(){this.triggerSync(5,!0)}static{this.\u0275fac=function(s){return new(s||r)(E(Ke))}}static{this.\u0275cmp=S({type:r,selectors:[["app-console-sync"]],decls:75,vars:18,consts:[[1,"console-sync-container"],[1,"header"],[1,"status-card"],[1,"status-grid"],[1,"status-item"],[1,"label"],[1,"value"],[1,"actions-card"],[1,"actions-grid"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-success",3,"click","disabled"],[1,"btn","btn-warning",3,"click","disabled"],[1,"btn","btn-info",3,"click","disabled"],["class","sync-progress",4,"ngIf"],[1,"stats-card"],[1,"stats-grid"],[1,"stat-item"],[1,"stat-number"],[1,"stat-label"],[1,"logs-card"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"logs-container"],["class","log-item",4,"ngFor","ngForOf"],["class","no-logs",4,"ngIf"],[1,"sync-progress"],[1,"spinner"],[1,"log-item"],[1,"log-time"],[1,"log-message"],[1,"no-logs"]],template:function(s,o){s&1&&(n(0,"div",0)(1,"div",1)(2,"h2"),i(3,"\u{1F504} Synchronisation Console Connect"),t(),n(4,"p"),i(5,"G\xE9rez la synchronisation automatique avec l'API Console Connect"),t()(),n(6,"div",2)(7,"h3"),i(8,"\u{1F4CA} Statut de synchronisation"),t(),n(9,"div",3)(10,"div",4)(11,"span",5),i(12,"Derni\xE8re synchronisation:"),t(),n(13,"span",6),i(14),t()(),n(15,"div",4)(16,"span",5),i(17,"Statut:"),t(),n(18,"span",6),i(19),t()(),n(20,"div",4)(21,"span",5),i(22,"eSIMs synchronis\xE9es:"),t(),n(23,"span",6),i(24),t()(),n(25,"div",4)(26,"span",5),i(27,"Packages synchronis\xE9s:"),t(),n(28,"span",6),i(29),t()()()(),n(30,"div",7)(31,"h3"),i(32,"\u26A1 Actions rapides"),t(),n(33,"div",8)(34,"button",9),f("click",function(){return o.testSync()}),i(35," \u{1F9EA} Test (5 eSIMs) "),t(),n(36,"button",10),f("click",function(){return o.quickSync()}),i(37," \u26A1 Rapide (50 eSIMs) "),t(),n(38,"button",11),f("click",function(){return o.fullSync()}),i(39," \u{1F504} Compl\xE8te (100 eSIMs + packages) "),t(),n(40,"button",12),f("click",function(){return o.testConnection()}),i(41," \u{1F50D} Tester connexion "),t()()(),h(42,Ft,4,0,"div",13),n(43,"div",14)(44,"h3"),i(45,"\u{1F4C8} Statistiques d\xE9taill\xE9es"),t(),n(46,"div",15)(47,"div",16)(48,"div",17),i(49),t(),n(50,"div",18),i(51,"eSIMs cr\xE9\xE9es"),t()(),n(52,"div",16)(53,"div",17),i(54),t(),n(55,"div",18),i(56,"eSIMs ignor\xE9es"),t()(),n(57,"div",16)(58,"div",17),i(59),t(),n(60,"div",18),i(61,"Packages cr\xE9\xE9s"),t()(),n(62,"div",16)(63,"div",17),i(64),t(),n(65,"div",18),i(66,"Erreurs"),t()()()(),n(67,"div",19)(68,"h3"),i(69,"\u{1F4CB} Logs r\xE9cents"),t(),n(70,"button",20),f("click",function(){return o.loadSyncLogs()}),i(71," \u{1F504} Actualiser les logs "),t(),n(72,"div",21),h(73,Nt,5,4,"div",22)(74,Lt,2,0,"div",23),t()()()),s&2&&(a(14),u(o.syncStatus.last_sync||"Jamais"),a(4),j(o.syncStatus.status||"unknown"),a(),_(" ",o.syncStatus.status||"Inconnu"," "),a(5),u(o.syncStats.total_esims||0),a(5),u(o.syncStats.total_packages||0),a(5),c("disabled",o.syncInProgress||o.isLoading),a(2),c("disabled",o.syncInProgress||o.isLoading),a(2),c("disabled",o.syncInProgress||o.isLoading),a(2),c("disabled",o.syncInProgress||o.isLoading),a(2),c("ngIf",o.syncInProgress),a(7),u(o.syncStats.esims_created||0),a(5),u(o.syncStats.esims_skipped||0),a(5),u(o.syncStats.packages_created||0),a(5),u(o.syncStats.errors||0),a(6),c("disabled",o.isLoading),a(3),c("ngForOf",o.syncLogs),a(),c("ngIf",o.syncLogs.length===0))},dependencies:[L,w],styles:[".console-sync-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:10px}.header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;font-size:16px}.status-card[_ngcontent-%COMP%], .actions-card[_ngcontent-%COMP%], .stats-card[_ngcontent-%COMP%], .logs-card[_ngcontent-%COMP%]{background:#fff;border-radius:10px;padding:20px;margin-bottom:20px;box-shadow:0 2px 10px #0000001a}.status-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .actions-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .stats-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .logs-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:15px;border-bottom:2px solid #3498db;padding-bottom:10px}.status-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px}.status-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#f8f9fa;border-radius:5px}.status-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:700;color:#2c3e50}.status-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#3498db;font-weight:700}.status-item[_ngcontent-%COMP%]   .value.success[_ngcontent-%COMP%]{color:#27ae60}.status-item[_ngcontent-%COMP%]   .value.error[_ngcontent-%COMP%]{color:#e74c3c}.status-item[_ngcontent-%COMP%]   .value.warning[_ngcontent-%COMP%]{color:#f39c12}.actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}.btn[_ngcontent-%COMP%]{padding:12px 20px;border:none;border-radius:5px;font-size:14px;font-weight:700;cursor:pointer;transition:all .3s ease}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#3498db;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2980b9}.btn-success[_ngcontent-%COMP%]{background:#27ae60;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#229954}.btn-warning[_ngcontent-%COMP%]{background:#f39c12;color:#fff}.btn-warning[_ngcontent-%COMP%]:hover:not(:disabled){background:#e67e22}.btn-info[_ngcontent-%COMP%]{background:#17a2b8;color:#fff}.btn-info[_ngcontent-%COMP%]:hover:not(:disabled){background:#138496}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268}.sync-progress[_ngcontent-%COMP%]{text-align:center;padding:20px;background:#e8f4fd;border-radius:10px;margin:20px 0}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 15px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:20px}.stat-item[_ngcontent-%COMP%]{text-align:center;padding:15px;background:#f8f9fa;border-radius:8px;border-left:4px solid #3498db}.stat-number[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3498db;margin-bottom:5px}.stat-label[_ngcontent-%COMP%]{color:#7f8c8d;font-size:14px}.logs-container[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;border:1px solid #ddd;border-radius:5px;padding:10px;background:#f8f9fa}.log-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid #eee;font-size:12px}.log-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.log-time[_ngcontent-%COMP%]{color:#7f8c8d;min-width:150px}.log-message[_ngcontent-%COMP%]{flex:1;margin-left:15px}.log-message.info[_ngcontent-%COMP%]{color:#3498db}.log-message.success[_ngcontent-%COMP%]{color:#27ae60}.log-message.warning[_ngcontent-%COMP%]{color:#f39c12}.log-message.error[_ngcontent-%COMP%]{color:#e74c3c}.no-logs[_ngcontent-%COMP%]{text-align:center;color:#7f8c8d;padding:20px}@media (max-width: 768px){.console-sync-container[_ngcontent-%COMP%]{padding:10px}.status-grid[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%], .stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.log-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.log-time[_ngcontent-%COMP%]{margin-bottom:5px}}"]})}}return r})();var $e=(()=>{class r{constructor(e){this.http=e,this.apiUrl=k}getAdminData(){let e=`${this.apiUrl}admin/destinations/data`;return console.log("\u{1F504} DestinationsService: Appel API getAdminData"),console.log("\u{1F4CD} URL appel\xE9e:",e),console.log("\u{1F517} URL compl\xE8te:",e),this.http.get(e)}getDestinations(){let e=`${this.apiUrl}destinations`;return console.log("\u{1F504} DestinationsService: Appel API getDestinations"),console.log("\u{1F4CD} URL appel\xE9e:",e),this.http.get(e)}getStats(){let e=`${this.apiUrl}destinations/stats`;return console.log("\u{1F504} DestinationsService: Appel API getStats"),console.log("\u{1F4CD} URL appel\xE9e:",e),this.http.get(e)}getDestination(e){let s=`${this.apiUrl}destinations/${e}`;return console.log("\u{1F504} DestinationsService: Appel API getDestination"),console.log("\u{1F4CD} URL appel\xE9e:",s),this.http.get(s)}checkAvailability(e,s=1){let o=`${this.apiUrl}destinations/check-availability`;return console.log("\u{1F504} DestinationsService: Appel API checkAvailability"),console.log("\u{1F4CD} URL appel\xE9e:",o),this.http.post(o,{package_id:e,quantity:s})}syncDestinations(e=20){let s=`${this.apiUrl}console-connect/sync`;return console.log("\u{1F504} DestinationsService: Appel API syncDestinations"),console.log("\u{1F4CD} URL appel\xE9e:",s),this.http.post(s,{sync_type:"destinations",limit:e})}static{this.\u0275fac=function(s){return new(s||r)(R(U))}}static{this.\u0275prov=q({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function zt(r,m){if(r&1){let e=y();n(0,"div",18),p(1,"i",19),i(2),n(3,"button",20),f("click",function(){x(e);let o=g();return C(o.clearMessages())}),i(4,"\xD7"),t()()}if(r&2){let e=g();a(2),_(" ",e.errorMessage," ")}}function Wt(r,m){if(r&1){let e=y();n(0,"div",21),p(1,"i",22),i(2),n(3,"button",20),f("click",function(){x(e);let o=g();return C(o.clearMessages())}),i(4,"\xD7"),t()()}if(r&2){let e=g();a(2),_(" ",e.successMessage," ")}}function jt(r,m){r&1&&(n(0,"div",23)(1,"div",24),p(2,"div",25),n(3,"p"),i(4,"Chargement des donn\xE9es..."),t()()())}function qt(r,m){if(r&1&&(n(0,"div",26)(1,"div",27)(2,"div",28),p(3,"i",29),t(),n(4,"div",30)(5,"p",31),i(6,"Destinations"),t(),n(7,"p",32),i(8),t()()(),n(9,"div",27)(10,"div",33),p(11,"i",34),t(),n(12,"div",30)(13,"p",31),i(14,"Packages"),t(),n(15,"p",32),i(16),t()()(),n(17,"div",27)(18,"div",35),p(19,"i",36),t(),n(20,"div",30)(21,"p",31),i(22,"eSIMs Disponibles"),t(),n(23,"p",32),i(24),t()()(),n(25,"div",27)(26,"div",37),p(27,"i",38),t(),n(28,"div",30)(29,"p",31),i(30,"Ruptures"),t(),n(31,"p",32),i(32),t()()()()),r&2){let e=g();a(8),u(e.stats.total_destinations),a(8),u(e.stats.total_packages),a(8),u(e.stats.available_esims),a(8),u(e.stats.out_of_stock_packages)}}function Rt(r,m){if(r&1&&(n(0,"div",55)(1,"div",56)(2,"h4",57),i(3),t(),n(4,"p",58),i(5),t()(),n(6,"div",59)(7,"p",60),i(8),t(),n(9,"p",61),i(10),t()()()),r&2){let e=m.$implicit,s=g(2);a(3),u(e.plan_name),a(2),W("",e.data_limit,"GB - ",e.validity_days," jours"),a(3),u(s.formatPrice(e.price)),a(2),W(" ",e.available_esims,"/",e.total_esims," disponibles ")}}function Bt(r,m){if(r&1){let e=y();n(0,"div",39)(1,"div",40)(2,"div",41)(3,"div",42)(4,"span",43),i(5),t()(),n(6,"div",44)(7,"h3",45),i(8),t(),n(9,"p",46),i(10),t()()(),n(11,"div",47),p(12,"span",48),n(13,"span",49),i(14),t()()(),n(15,"div",50),h(16,Rt,11,6,"div",51),t(),n(17,"div",52)(18,"button",53),f("click",function(){let o=x(e).$implicit,d=g();return C(d.viewDestinationDetails(o))}),p(19,"i",54),i(20," Voir les d\xE9tails "),t()()()}if(r&2){let e=m.$implicit,s=g();a(5),u(e.country_code),a(3),u(e.country_name),a(2),u(e.network_provider),a(2),j(s.getOverallStatus(e).class),a(),j(s.getOverallStatus(e).color),a(),_(" ",s.getOverallStatus(e).text," "),a(2),c("ngForOf",e.packages)}}function Ut(r,m){r&1&&p(0,"i",73)}function Gt(r,m){r&1&&p(0,"i",8)}function Ht(r,m){if(r&1){let e=y();n(0,"div",62),f("click",function(){x(e);let o=g();return C(o.closeSyncModal())}),n(1,"div",63),f("click",function(o){return x(e),C(o.stopPropagation())}),n(2,"div",64)(3,"h3"),i(4,"Synchronisation des Destinations"),t(),n(5,"button",65),f("click",function(){x(e);let o=g();return C(o.closeSyncModal())}),i(6,"\xD7"),t()(),n(7,"div",66)(8,"div",67)(9,"label"),i(10,"Nombre d'eSIMs \xE0 traiter"),t(),n(11,"input",68),M("ngModelChange",function(o){x(e);let d=g();return v(d.syncLimit,o)||(d.syncLimit=o),C(o)}),t()()(),n(12,"div",69)(13,"button",9),f("click",function(){x(e);let o=g();return C(o.closeSyncModal())}),i(14,"Annuler"),t(),n(15,"button",70),f("click",function(){x(e);let o=g();return C(o.syncDestinations())}),h(16,Ut,1,0,"i",71)(17,Gt,1,0,"i",72),i(18),t()()()()}if(r&2){let e=g();a(11),b("ngModel",e.syncLimit),a(4),c("disabled",e.syncLoading),a(),c("ngIf",e.syncLoading),a(),c("ngIf",!e.syncLoading),a(),_(" ",e.syncLoading?"Synchronisation...":"Synchroniser"," ")}}function Yt(r,m){if(r&1&&(n(0,"div",83)(1,"div",84)(2,"h5"),i(3),t(),n(4,"span",85),i(5),t()(),n(6,"div",86)(7,"div",87)(8,"p")(9,"strong"),i(10,"Donn\xE9es:"),t(),i(11),t(),n(12,"p")(13,"strong"),i(14,"Validit\xE9:"),t(),i(15),t(),n(16,"p")(17,"strong"),i(18,"Prix:"),t(),i(19),t()(),n(20,"div",88)(21,"p")(22,"strong"),i(23,"Stock:"),t(),i(24),t(),n(25,"div",89),p(26,"div",90),t()()()()),r&2){let e=m.$implicit,s=g(2);a(3),u(e.plan_name),a(),j(s.getStockStatus(e).class),a(),_(" ",s.getStockStatus(e).text," "),a(6),_(" ",e.data_limit,"GB"),a(4),_(" ",e.validity_days," jours"),a(4),_(" ",s.formatPrice(e.price),""),a(5),W(" ",e.available_esims,"/",e.total_esims,""),a(2),we("width",e.stock_percentage,"%")}}function Qt(r,m){if(r&1){let e=y();n(0,"div",62),f("click",function(){x(e);let o=g();return C(o.closeDetailsModal())}),n(1,"div",74),f("click",function(o){return x(e),C(o.stopPropagation())}),n(2,"div",64)(3,"h3"),i(4),t(),n(5,"button",65),f("click",function(){x(e);let o=g();return C(o.closeDetailsModal())}),i(6,"\xD7"),t()(),n(7,"div",66)(8,"div",75)(9,"div",76)(10,"h4"),i(11,"Informations g\xE9n\xE9rales"),t(),n(12,"div",77)(13,"div",78)(14,"span",79),i(15,"Pays:"),t(),n(16,"span",80),i(17),t()(),n(18,"div",78)(19,"span",79),i(20,"Code:"),t(),n(21,"span",80),i(22),t()(),n(23,"div",78)(24,"span",79),i(25,"Op\xE9rateur:"),t(),n(26,"span",80),i(27),t()()()(),n(28,"div",76)(29,"h4"),i(30,"Packages disponibles"),t(),n(31,"div",81),h(32,Yt,27,11,"div",82),t()()()()()()}if(r&2){let e=g();a(4),_("D\xE9tails - ",e.selectedDestination.country_name,""),a(13),u(e.selectedDestination.country_name),a(5),u(e.selectedDestination.country_code),a(5),u(e.selectedDestination.network_provider),a(5),c("ngForOf",e.selectedDestination.packages)}}var et=(()=>{class r{constructor(e){this.destinationsService=e,this.destinations=[],this.stats=null,this.loading=!1,this.syncLoading=!1,this.selectedDestination=null,this.showDetailsModal=!1,this.showSyncModal=!1,this.syncLimit=20,this.errorMessage="",this.successMessage=""}ngOnInit(){this.loadData()}loadData(){this.loading=!0,this.errorMessage="",console.log("\u{1F504} DestinationsComponent: D\xE9but loadData"),this.destinationsService.getAdminData().subscribe({next:e=>{console.log("\u2705 DestinationsComponent: R\xE9ponse re\xE7ue",e),e.success?(this.destinations=e.destinations,this.stats=e.stats,console.log("\u{1F4CA} DestinationsComponent: Donn\xE9es charg\xE9es",{destinations:this.destinations.length,stats:this.stats})):(console.error("\u274C DestinationsComponent: Erreur dans la r\xE9ponse",e),this.errorMessage="Erreur lors du chargement des donn\xE9es")},error:e=>{console.error("\u274C DestinationsComponent: Erreur HTTP",e),console.error("\u{1F4CD} URL qui a \xE9chou\xE9:",e.url),console.error("\u{1F4CA} Status:",e.status),console.error("\u{1F4DD} Message:",e.message),this.errorMessage="Erreur de connexion au serveur"},complete:()=>{console.log("\u2705 DestinationsComponent: loadData termin\xE9"),this.loading=!1}})}syncDestinations(){this.syncLoading=!0,this.errorMessage="",this.successMessage="",this.destinationsService.syncDestinations(this.syncLimit).subscribe({next:e=>{e.success?(this.successMessage="Synchronisation r\xE9ussie !",this.showSyncModal=!1,setTimeout(()=>{this.loadData()},2e3)):this.errorMessage=e.message||"Erreur lors de la synchronisation"},error:e=>{console.error("Erreur sync:",e),this.errorMessage="Erreur de connexion lors de la synchronisation"},complete:()=>{this.syncLoading=!1}})}viewDestinationDetails(e){this.selectedDestination=e,this.showDetailsModal=!0}closeDetailsModal(){this.showDetailsModal=!1,this.selectedDestination=null}openSyncModal(){this.showSyncModal=!0}closeSyncModal(){this.showSyncModal=!1}getStockStatus(e){return e.available_esims===0?{class:"stock-out",text:"Rupture",color:"text-gray-500"}:e.available_esims<=2?{class:"stock-low",text:"Stock faible",color:"text-red-500"}:e.available_esims<=5?{class:"stock-medium",text:"Stock moyen",color:"text-yellow-500"}:{class:"stock-high",text:"En stock",color:"text-green-500"}}formatPrice(e){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(e)}clearMessages(){this.errorMessage="",this.successMessage=""}getOverallStatus(e){let s=e.packages.length,o=e.packages.filter(d=>d.in_stock).length;return o===0?{class:"stock-out",text:"Rupture",color:"text-gray-500"}:o<=s*.3?{class:"stock-low",text:"Stock faible",color:"text-red-500"}:o<=s*.7?{class:"stock-medium",text:"Stock moyen",color:"text-yellow-500"}:{class:"stock-high",text:"En stock",color:"text-green-500"}}static{this.\u0275fac=function(s){return new(s||r)(E($e))}}static{this.\u0275cmp=S({type:r,selectors:[["app-destinations"]],standalone:!0,features:[P],decls:22,vars:7,consts:[[1,"destinations-container"],[1,"header-section"],[1,"header-content"],[1,"header-left"],[1,"fas","fa-globe","header-icon"],[1,"header-title"],[1,"header-actions"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-sync-alt"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-refresh"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","loading-overlay",4,"ngIf"],["class","stats-grid",4,"ngIf"],[1,"destinations-grid"],["class","destination-card",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"alert","alert-error"],[1,"fas","fa-exclamation-circle"],[1,"alert-close",3,"click"],[1,"alert","alert-success"],[1,"fas","fa-check-circle"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"spinner"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-icon","stat-icon-blue"],[1,"fas","fa-globe"],[1,"stat-content"],[1,"stat-label"],[1,"stat-value"],[1,"stat-icon","stat-icon-green"],[1,"fas","fa-box"],[1,"stat-icon","stat-icon-purple"],[1,"fas","fa-sim-card"],[1,"stat-icon","stat-icon-red"],[1,"fas","fa-exclamation-triangle"],[1,"destination-card"],[1,"card-header"],[1,"destination-info"],[1,"destination-flag"],[1,"flag-code"],[1,"destination-details"],[1,"destination-name"],[1,"destination-provider"],[1,"destination-status"],[1,"status-indicator"],[1,"status-text"],[1,"packages-list"],["class","package-item",4,"ngFor","ngForOf"],[1,"card-actions"],[1,"btn","btn-outline",3,"click"],[1,"fas","fa-eye"],[1,"package-item"],[1,"package-info"],[1,"package-name"],[1,"package-details"],[1,"package-pricing"],[1,"package-price"],[1,"package-stock"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body"],[1,"form-group"],["type","number","min","1","max","100",1,"form-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn","btn-primary",3,"click","disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],["class","fas fa-sync-alt",4,"ngIf"],[1,"fas","fa-spinner","fa-spin"],[1,"modal-content","modal-large",3,"click"],[1,"destination-details-full"],[1,"detail-section"],[1,"detail-grid"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[1,"packages-detail-grid"],["class","package-detail-card",4,"ngFor","ngForOf"],[1,"package-detail-card"],[1,"package-detail-header"],[1,"stock-badge"],[1,"package-detail-content"],[1,"package-specs"],[1,"package-stock-info"],[1,"stock-bar"],[1,"stock-fill"]],template:function(s,o){s&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),p(4,"i",4),n(5,"h1",5),i(6,"Gestion des Destinations"),t()(),n(7,"div",6)(8,"button",7),f("click",function(){return o.openSyncModal()}),p(9,"i",8),i(10," Synchroniser "),t(),n(11,"button",9),f("click",function(){return o.loadData()}),p(12,"i",10),i(13," Actualiser "),t()()()(),h(14,zt,5,1,"div",11)(15,Wt,5,1,"div",12)(16,jt,5,0,"div",13)(17,qt,33,4,"div",14),n(18,"div",15),h(19,Bt,21,9,"div",16),t(),h(20,Ht,19,5,"div",17)(21,Qt,33,5,"div",17),t()),s&2&&(a(14),c("ngIf",o.errorMessage),a(),c("ngIf",o.successMessage),a(),c("ngIf",o.loading),a(),c("ngIf",o.stats),a(2),c("ngForOf",o.destinations),a(),c("ngIf",o.showSyncModal),a(),c("ngIf",o.showDetailsModal&&o.selectedDestination))},dependencies:[A,L,w,z,T,Z,F,$,ze,V],styles:[".destinations-container[_ngcontent-%COMP%]{padding:20px;background-color:#f8fafc;min-height:100vh}.header-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px;margin-bottom:24px;box-shadow:0 4px 6px -1px #0000001a}.header-content[_ngcontent-%COMP%]{padding:24px;display:flex;justify-content:space-between;align-items:center}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.header-icon[_ngcontent-%COMP%]{font-size:24px}.header-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:600;border:none;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:all .2s ease;font-size:14px}.btn-primary[_ngcontent-%COMP%]{background-color:#fff;color:#667eea}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#f8fafc;transform:translateY(-1px)}.btn-secondary[_ngcontent-%COMP%]{background-color:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3)}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#ffffff4d}.btn-outline[_ngcontent-%COMP%]{background-color:transparent;color:#667eea;border:2px solid #667eea}.btn-outline[_ngcontent-%COMP%]:hover{background-color:#667eea;color:#fff}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:8px;margin-bottom:16px;display:flex;align-items:center;gap:8px;position:relative}.alert-error[_ngcontent-%COMP%]{background-color:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert-success[_ngcontent-%COMP%]{background-color:#f0fdf4;color:#16a34a;border:1px solid #bbf7d0}.alert-close[_ngcontent-%COMP%]{position:absolute;right:12px;background:none;border:none;font-size:18px;cursor:pointer;color:inherit}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{background-color:#fff;padding:24px;border-radius:12px;text-align:center;box-shadow:0 20px 25px -5px #0000001a}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f4f6;border-top:4px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 12px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:32px}.stat-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;padding:24px;box-shadow:0 1px 3px #0000001a;display:flex;align-items:center;gap:16px;transition:transform .2s ease,box-shadow .2s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 6px -1px #0000001a}.stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px}.stat-icon-blue[_ngcontent-%COMP%]{background-color:#dbeafe;color:#2563eb}.stat-icon-green[_ngcontent-%COMP%]{background-color:#dcfce7;color:#16a34a}.stat-icon-purple[_ngcontent-%COMP%]{background-color:#f3e8ff;color:#9333ea}.stat-icon-red[_ngcontent-%COMP%]{background-color:#fee2e2;color:#dc2626}.stat-content[_ngcontent-%COMP%]{flex:1}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin:0 0 4px;font-weight:500}.stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#111827;margin:0}.destinations-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:24px}.destination-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;overflow:hidden;transition:transform .2s ease,box-shadow .2s ease}.destination-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 10px 15px -3px #0000001a}.card-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}.destination-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.destination-flag[_ngcontent-%COMP%]{width:48px;height:48px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:16px}.destination-details[_ngcontent-%COMP%]{flex:1}.destination-name[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#111827;margin:0 0 4px}.destination-provider[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin:0}.destination-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.status-indicator[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;display:inline-block}.status-text[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.stock-high[_ngcontent-%COMP%]{background-color:#10b981}.stock-medium[_ngcontent-%COMP%]{background-color:#f59e0b}.stock-low[_ngcontent-%COMP%]{background-color:#ef4444}.stock-out[_ngcontent-%COMP%]{background-color:#6b7280}.packages-list[_ngcontent-%COMP%]{padding:20px}.package-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f3f4f6}.package-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.package-info[_ngcontent-%COMP%]{flex:1}.package-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#111827;margin:0 0 4px}.package-details[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin:0}.package-pricing[_ngcontent-%COMP%]{text-align:right}.package-price[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#111827;margin:0 0 4px}.package-stock[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin:0}.card-actions[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #e5e7eb}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 25px -5px #0000001a}.modal-large[_ngcontent-%COMP%]{max-width:800px}.modal-header[_ngcontent-%COMP%]{padding:24px;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#111827}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#6b7280;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:6px;transition:background-color .2s ease}.modal-close[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.modal-body[_ngcontent-%COMP%]{padding:24px}.modal-footer[_ngcontent-%COMP%]{padding:24px;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:12px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px}.form-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;transition:border-color .2s ease}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.destination-details-full[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.detail-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#111827;margin:0 0 16px}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px;background-color:#f9fafb;border-radius:8px}.detail-label[_ngcontent-%COMP%]{font-weight:500;color:#6b7280}.detail-value[_ngcontent-%COMP%]{font-weight:600;color:#111827}.packages-detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.package-detail-card[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;padding:16px;background-color:#f9fafb}.package-detail-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.package-detail-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#111827}.stock-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:600;color:#fff}.package-detail-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.package-specs[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;color:#374151}.package-stock-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:14px;color:#374151}.stock-bar[_ngcontent-%COMP%]{width:100%;height:8px;background-color:#e5e7eb;border-radius:4px;overflow:hidden}.stock-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#10b981,#059669);transition:width .3s ease}@media (max-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.header-actions[_ngcontent-%COMP%]{width:100%;justify-content:center}.stats-grid[_ngcontent-%COMP%], .destinations-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-content[_ngcontent-%COMP%]{width:95%;margin:20px}}"]})}}return r})();var tt=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${k}admin/esims`}getEsims(){return this.http.get(`${this.apiUrl}/data`)}updateEsimStatus(e,s){return this.http.put(`${this.apiUrl}/${e}/status`,s)}deleteEsim(e){return this.http.delete(`${this.apiUrl}/${e}`)}getStatusColor(e){switch(e){case"available":return"success";case"assigned":return"primary";case"activated":return"info";case"expired":return"warning";case"error":return"danger";default:return"secondary"}}getStatusLabel(e){switch(e){case"available":return"Disponible";case"assigned":return"Assign\xE9e";case"activated":return"Activ\xE9e";case"expired":return"Expir\xE9e";case"error":return"Erreur";default:return"Inconnu"}}static{this.\u0275fac=function(s){return new(s||r)(R(U))}}static{this.\u0275prov=q({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Xt(r,m){if(r&1&&(n(0,"div",11)(1,"div",12)(2,"div",13),i(3),t(),n(4,"div",14),i(5,"Total eSIMs"),t()(),n(6,"div",12)(7,"div",13),i(8),t(),n(9,"div",14),i(10,"Assign\xE9es"),t()(),n(11,"div",12)(12,"div",13),i(13),t(),n(14,"div",14),i(15,"Non assign\xE9es"),t()(),n(16,"div",12)(17,"div",13),i(18),t(),n(19,"div",14),i(20,"Assign\xE9es cette semaine"),t()()()),r&2){let e=g();a(3),u(e.stats.total),a(5),u(e.stats.assigned),a(5),u(e.stats.unassigned),a(5),u(e.stats.recently_assigned)}}function Kt(r,m){if(r&1&&(n(0,"div",15),i(1),t()),r&2){let e=g();a(),_(" ",e.error," ")}}function Zt(r,m){r&1&&(n(0,"div",16),p(1,"div",17),n(2,"p"),i(3,"Chargement des eSIMs..."),t()())}function $t(r,m){if(r&1&&(n(0,"span",40),i(1),t()),r&2){let e=g().$implicit;a(),W(" ",e.esim_package.name," - ",e.esim_package.destination," ")}}function en(r,m){r&1&&(n(0,"span",41),i(1," Non assign\xE9e "),t())}function tn(r,m){if(r&1&&(n(0,"span",42),i(1),t()),r&2){let e=g().$implicit,s=g(2);a(),_(" ",s.formatDate(e.assigned_at)," ")}}function nn(r,m){r&1&&(n(0,"span",43),i(1," - "),t())}function on(r,m){if(r&1){let e=y();n(0,"tr",22)(1,"td"),i(2),t(),n(3,"td")(4,"div",23)(5,"span",24),i(6),t(),n(7,"button",25),f("click",function(){let o=x(e).$implicit,d=g(2);return C(d.copyToClipboard(o.iccid))}),i(8," \u{1F4CB} "),t()()(),n(9,"td")(10,"div",26)(11,"span",27),i(12),t(),n(13,"button",28),f("click",function(){let o=x(e).$implicit,d=g(2);return C(d.copyToClipboard(o.activation_code))}),i(14," \u{1F4CB} "),t()()(),n(15,"td")(16,"div",29)(17,"span",30),i(18),t(),n(19,"button",31),f("click",function(){let o=x(e).$implicit,d=g(2);return C(d.copyToClipboard(o.lpa))}),i(20," \u{1F4CB} "),t()()(),n(21,"td"),h(22,$t,2,2,"span",32)(23,en,2,0,"span",33),t(),n(24,"td")(25,"span",34),i(26),t()(),n(27,"td"),h(28,tn,2,1,"span",35)(29,nn,2,0,"span",36),t(),n(30,"td"),i(31),t(),n(32,"td")(33,"div",37)(34,"button",38),f("click",function(){let o=x(e).$implicit,d=g(2);return C(d.editEsim(o))}),i(35," \u270F\uFE0F "),t(),n(36,"button",39),f("click",function(){let o=x(e).$implicit,d=g(2);return C(d.deleteEsim(o.id))}),i(37," \u{1F5D1}\uFE0F "),t()()()()}if(r&2){let e=m.$implicit,s=g(2);a(2),u(e.id),a(4),u(e.iccid),a(6),u(e.activation_code),a(6),u(e.lpa),a(4),c("ngIf",e.esim_package),a(),c("ngIf",!e.esim_package),a(2),pe("true",e.is_assigned)("false",!e.is_assigned),a(),_(" ",e.is_assigned?"Oui":"Non"," "),a(2),c("ngIf",e.assigned_at),a(),c("ngIf",!e.assigned_at),a(2),u(s.formatDate(e.created_at))}}function an(r,m){r&1&&(n(0,"div",44)(1,"p"),i(2,"Aucune eSIM trouv\xE9e avec les filtres actuels."),t()())}function rn(r,m){if(r&1&&(n(0,"div",18)(1,"table",19)(2,"thead")(3,"tr")(4,"th"),i(5,"ID"),t(),n(6,"th"),i(7,"ICCID"),t(),n(8,"th"),i(9,"Code d'activation"),t(),n(10,"th"),i(11,"LPA"),t(),n(12,"th"),i(13,"Package"),t(),n(14,"th"),i(15,"Assign\xE9e"),t(),n(16,"th"),i(17,"Date assignation"),t(),n(18,"th"),i(19,"Date cr\xE9ation"),t(),n(20,"th"),i(21,"Actions"),t()()(),n(22,"tbody"),h(23,on,38,14,"tr",20),t()(),h(24,an,3,0,"div",21),t()),r&2){let e=g();a(23),c("ngForOf",e.filteredEsims),a(),c("ngIf",e.filteredEsims.length===0)}}function sn(r,m){if(r&1){let e=y();n(0,"div",53)(1,"div",54)(2,"label")(3,"input",55),M("ngModelChange",function(o){x(e);let d=g(2);return v(d.selectedEsim.is_assigned,o)||(d.selectedEsim.is_assigned=o),C(o)}),t(),i(4," Assign\xE9e "),t()(),n(5,"div",54)(6,"label"),i(7,"Date d'assignation:"),t(),n(8,"input",56),M("ngModelChange",function(o){x(e);let d=g(2);return v(d.selectedEsim.assigned_at,o)||(d.selectedEsim.assigned_at=o),C(o)}),t()()()}if(r&2){let e=g(2);a(3),b("ngModel",e.selectedEsim.is_assigned),a(5),b("ngModel",e.selectedEsim.assigned_at)}}function ln(r,m){if(r&1){let e=y();n(0,"div",45),f("click",function(){x(e);let o=g();return C(o.showEditModal=!1)}),n(1,"div",46),f("click",function(o){return x(e),C(o.stopPropagation())}),n(2,"div",47)(3,"h3"),i(4),t(),n(5,"button",48),f("click",function(){x(e);let o=g();return C(o.showEditModal=!1)}),i(6,"\xD7"),t()(),h(7,sn,9,2,"div",49),n(8,"div",50)(9,"button",51),f("click",function(){x(e);let o=g();return C(o.showEditModal=!1)}),i(10,"Annuler"),t(),n(11,"button",52),f("click",function(){x(e);let o=g();return C(o.updateEsimStatus())}),i(12,"Sauvegarder"),t()()()()}if(r&2){let e=g();a(4),_("Modifier l'eSIM #",e.selectedEsim==null?null:e.selectedEsim.id,""),a(3),c("ngIf",e.selectedEsim)}}var nt=(()=>{class r{constructor(e){this.esimService=e,this.esims=[],this.stats=null,this.loading=!1,this.error="",this.searchTerm="",this.selectedEsim=null,this.showEditModal=!1}ngOnInit(){this.loadEsims()}loadEsims(){this.loading=!0,this.error="",this.esimService.getEsims().subscribe({next:e=>{this.esims=e.esims,this.stats=e.stats,this.loading=!1},error:e=>{console.error("Erreur lors du chargement des eSIMs:",e),this.error="Erreur lors du chargement des eSIMs",this.loading=!1}})}get filteredEsims(){let e=this.esims;return this.searchTerm&&(e=e.filter(s=>s.iccid.toLowerCase().includes(this.searchTerm.toLowerCase())||s.activation_code.toLowerCase().includes(this.searchTerm.toLowerCase())||s.lpa.toLowerCase().includes(this.searchTerm.toLowerCase()))),e}editEsim(e){this.selectedEsim=de({},e),this.showEditModal=!0}updateEsimStatus(){this.selectedEsim&&this.esimService.updateEsimStatus(this.selectedEsim.id,{is_assigned:this.selectedEsim.is_assigned,assigned_at:this.selectedEsim.assigned_at}).subscribe({next:e=>{this.loadEsims(),this.showEditModal=!1,this.selectedEsim=null},error:e=>{console.error("Erreur lors de la mise \xE0 jour:",e),this.error="Erreur lors de la mise \xE0 jour du statut"}})}deleteEsim(e){confirm("\xCAtes-vous s\xFBr de vouloir supprimer cette eSIM ?")&&this.esimService.deleteEsim(e).subscribe({next:()=>{this.loadEsims()},error:s=>{console.error("Erreur lors de la suppression:",s),this.error="Erreur lors de la suppression"}})}copyToClipboard(e){navigator.clipboard.writeText(e).then(()=>{})}formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}static{this.\u0275fac=function(s){return new(s||r)(E(tt))}}static{this.\u0275cmp=S({type:r,selectors:[["app-esim-admin"]],standalone:!0,features:[P],decls:16,vars:6,consts:[[1,"esim-admin-container"],[1,"header"],["class","stats-grid",4,"ngIf"],[1,"filters"],[1,"search-box"],["type","text","placeholder","Rechercher par ICCID, code d'activation...",1,"search-input",3,"ngModelChange","ngModel"],[1,"refresh-btn",3,"click"],["class","error-message",4,"ngIf"],["class","loading",4,"ngIf"],["class","table-container",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-number"],[1,"stat-label"],[1,"error-message"],[1,"loading"],[1,"spinner"],[1,"table-container"],[1,"esim-table"],["class","esim-row",4,"ngFor","ngForOf"],["class","no-data",4,"ngIf"],[1,"esim-row"],[1,"iccid-cell"],[1,"iccid-text"],["title","Copier ICCID",1,"copy-btn",3,"click"],[1,"activation-cell"],[1,"activation-text"],["title","Copier le code",1,"copy-btn",3,"click"],[1,"lpa-cell"],[1,"lpa-text"],["title","Copier LPA",1,"copy-btn",3,"click"],["class","package-info",4,"ngIf"],["class","no-package",4,"ngIf"],[1,"boolean-badge"],["class","date-text",4,"ngIf"],["class","no-date",4,"ngIf"],[1,"actions"],["title","Modifier",1,"action-btn","edit-btn",3,"click"],["title","Supprimer",1,"action-btn","delete-btn",3,"click"],[1,"package-info"],[1,"no-package"],[1,"date-text"],[1,"no-date"],[1,"no-data"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],["class","modal-body",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"modal-body"],[1,"form-group"],["type","checkbox",3,"ngModelChange","ngModel"],["type","datetime-local",1,"form-select",3,"ngModelChange","ngModel"]],template:function(s,o){s&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),i(3,"\u{1F4F1} Gestion des eSIMs"),t(),n(4,"p"),i(5,"G\xE9rez toutes vos eSIMs import\xE9es depuis Console Connect"),t()(),h(6,Xt,21,4,"div",2),n(7,"div",3)(8,"div",4)(9,"input",5),M("ngModelChange",function(l){return v(o.searchTerm,l)||(o.searchTerm=l),l}),t()(),n(10,"button",6),f("click",function(){return o.loadEsims()}),i(11," \u{1F504} Actualiser "),t()(),h(12,Kt,2,1,"div",7)(13,Zt,4,0,"div",8)(14,rn,25,2,"div",9)(15,ln,13,2,"div",10),t()),s&2&&(a(6),c("ngIf",o.stats),a(3),b("ngModel",o.searchTerm),a(3),c("ngIf",o.error),a(),c("ngIf",o.loading),a(),c("ngIf",!o.loading),a(),c("ngIf",o.showEditModal))},dependencies:[A,L,w,z,T,Ne,F,V],styles:[".esim-admin-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:.5rem;font-size:2.5rem}.header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;font-size:1.1rem}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:2rem}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:1.5rem;border-radius:12px;text-align:center;box-shadow:0 4px 15px #0000001a;transition:transform .3s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.stat-number[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;margin-bottom:.5rem}.stat-label[_ngcontent-%COMP%]{font-size:.9rem;opacity:.9}.filters[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem;align-items:center;flex-wrap:wrap}.search-input[_ngcontent-%COMP%]{padding:.75rem 1rem;border:2px solid #e1e8ed;border-radius:8px;font-size:1rem;min-width:300px;transition:border-color .3s ease}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea}.status-select[_ngcontent-%COMP%]{padding:.75rem 1rem;border:2px solid #e1e8ed;border-radius:8px;font-size:1rem;background:#fff;min-width:150px}.refresh-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#27ae60;color:#fff;border:none;border-radius:8px;font-size:1rem;cursor:pointer;transition:background-color .3s ease}.refresh-btn[_ngcontent-%COMP%]:hover{background:#229954}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 4px 15px #0000001a;overflow:hidden}.esim-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.9rem}.esim-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa;padding:1rem;text-align:left;font-weight:600;color:#2c3e50;border-bottom:2px solid #e1e8ed}.esim-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #e1e8ed;vertical-align:middle}.esim-row[_ngcontent-%COMP%]:hover{background:#f8f9fa}.iccid-cell[_ngcontent-%COMP%], .activation-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.iccid-text[_ngcontent-%COMP%], .activation-text[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-size:.8rem;color:#2c3e50;word-break:break-all}.copy-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:1rem;padding:.25rem;border-radius:4px;transition:background-color .3s ease}.copy-btn[_ngcontent-%COMP%]:hover{background:#e1e8ed}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.8rem;font-weight:500;text-transform:uppercase}.status-success[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-primary[_ngcontent-%COMP%]{background:#cce7ff;color:#004085}.status-info[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-warning[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-danger[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-secondary[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.boolean-badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:12px;font-size:.8rem;font-weight:500}.boolean-badge.true[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.boolean-badge.false[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.package-info[_ngcontent-%COMP%]{font-size:.8rem;color:#2c3e50;font-weight:500}.no-package[_ngcontent-%COMP%]{font-size:.8rem;color:#7f8c8d;font-style:italic}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:1.2rem;padding:.5rem;border-radius:6px;transition:background-color .3s ease}.edit-btn[_ngcontent-%COMP%]:hover{background:#e3f2fd}.delete-btn[_ngcontent-%COMP%]:hover{background:#ffebee}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;max-width:500px;width:90%;max-height:80vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid #e1e8ed}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#7f8c8d}.close-btn[_ngcontent-%COMP%]:hover{color:#2c3e50}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:#2c3e50}.form-select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:2px solid #e1e8ed;border-radius:8px;font-size:1rem}.form-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:.5rem}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;margin-top:2rem;padding-top:1rem;border-top:1px solid #e1e8ed}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:8px;font-size:1rem;cursor:pointer;transition:background-color .3s ease}.btn-primary[_ngcontent-%COMP%]{background:#667eea;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#5a6fd8}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background:#5a6268}.loading[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#7f8c8d}.spinner[_ngcontent-%COMP%]{border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:1rem;border-radius:8px;margin-bottom:1rem;border:1px solid #f5c6cb}.no-data[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#7f8c8d}@media (max-width: 768px){.esim-admin-container[_ngcontent-%COMP%]{padding:1rem}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.filters[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-input[_ngcontent-%COMP%]{min-width:auto}.esim-table[_ngcontent-%COMP%]{font-size:.8rem}.esim-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .esim-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}}"]})}}return r})();var it=(()=>{class r{constructor(e){this.http=e}getEsimsFromConsoleConnect(){return this.http.get(`${k}admin/console-connect/esims`)}getEsimDetails(e){return this.http.get(`${k}admin/console-connect/esims/${e}/details`)}getPackageDetails(e){return this.http.get(`${k}admin/console-connect/packages/${e}/details`)}formatStatus(e){return e?{active:"Actif",inactive:"Inactif",pending:"En attente",expired:"Expir\xE9",suspended:"Suspendu",unknown:"Inconnu"}[e]||e:"Inconnu"}formatDestination(e){return e?{france:"France",china:"Chine",usa:"\xC9tats-Unis",uk:"Royaume-Uni",germany:"Allemagne",spain:"Espagne",italy:"Italie",japan:"Japon",australia:"Australie",canada:"Canada",brazil:"Br\xE9sil",india:"Inde",south_africa:"Afrique du Sud"}[e]||e:"Inconnu"}formatDataLimit(e){if(!e)return"Non sp\xE9cifi\xE9";if(e.includes("GB")||e.includes("MB"))return e;let s=parseInt(e);return isNaN(s)?"Non sp\xE9cifi\xE9":s>=1024?`${(s/1024).toFixed(1)} GB`:`${s} MB`}formatPrice(e,s="EUR"){if(!e||isNaN(e))return"Non sp\xE9cifi\xE9";let d={EUR:"\u20AC",USD:"$",GBP:"\xA3",CNY:"\xA5"}[s||"EUR"]||s||"EUR";return`${e.toFixed(2)} ${d}`}formatDate(e){return e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Non sp\xE9cifi\xE9"}getStatusClass(e){return e||(e="unknown"),{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",pending:"bg-yellow-100 text-yellow-800",expired:"bg-red-100 text-red-800",suspended:"bg-orange-100 text-orange-800",unknown:"bg-gray-100 text-gray-800"}[e]||"bg-gray-100 text-gray-800"}static{this.\u0275fac=function(s){return new(s||r)(R(U))}}static{this.\u0275prov=q({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function cn(r,m){if(r&1&&(n(0,"div",41),p(1,"i",42),i(2),D(3,"date"),t()),r&2){let e=g(2);a(2),_(" Derni\xE8re synchronisation: ",N(3,1,e.stockStats.last_sync,"short")," ")}}function mn(r,m){if(r&1&&(n(0,"div",46)(1,"span",47),i(2),t(),n(3,"span",48),i(4),t()()),r&2){let e=m.$implicit;a(2),u(e.key),a(2),u(e.value)}}function pn(r,m){if(r&1&&(n(0,"div",43)(1,"h3"),i(2,"R\xE9partition par statut"),t(),n(3,"div",44),h(4,mn,5,2,"div",45),t()()),r&2){let e=g(2);a(4),c("ngForOf",e.getStatusItems())}}function gn(r,m){if(r&1&&(n(0,"div",23)(1,"div",24)(2,"h2"),p(3,"i",25),i(4," Statistiques du Stock eSIM"),t(),h(5,cn,4,4,"div",26),t(),n(6,"div",27)(7,"div",28)(8,"div",29),p(9,"i",30),t(),n(10,"div",31)(11,"div",32),i(12),t(),n(13,"div",33),i(14,"Total eSIMs"),t()()(),n(15,"div",34)(16,"div",29),p(17,"i",35),t(),n(18,"div",31)(19,"div",32),i(20),t(),n(21,"div",33),i(22,"Disponibles"),t()()(),n(23,"div",36)(24,"div",29),p(25,"i",37),t(),n(26,"div",31)(27,"div",32),i(28),t(),n(29,"div",33),i(30,"Utilis\xE9es"),t()()(),n(31,"div",38)(32,"div",29),p(33,"i",39),t(),n(34,"div",31)(35,"div",32),i(36),t(),n(37,"div",33),i(38,"D\xE9sactiv\xE9es"),t()()()(),h(39,pn,5,1,"div",40),t()),r&2){let e=g();a(5),c("ngIf",e.stockStats.last_sync),a(7),u(e.stockStats.total||0),a(8),u(e.stockStats.available||0),a(8),u(e.stockStats.used||0),a(8),u(e.stockStats.disabled||0),a(3),c("ngIf",e.stockStats.by_status)}}function un(r,m){if(r&1&&(n(0,"div",52),p(1,"i",53),i(2),t()),r&2){let e=g(2);a(2),_(" ",e.error," ")}}function fn(r,m){if(r&1&&(n(0,"div",54),p(1,"i",35),i(2),t()),r&2){let e=g(2);a(2),_(" ",e.success," ")}}function _n(r,m){if(r&1&&(n(0,"div",49),h(1,un,3,1,"div",50)(2,fn,3,1,"div",51),t()),r&2){let e=g();a(),c("ngIf",e.error),a(),c("ngIf",e.success)}}function hn(r,m){if(r&1){let e=y();n(0,"tr",55)(1,"td",56),i(2),t(),n(3,"td",57),i(4),t(),n(5,"td",58),i(6),t(),n(7,"td",59)(8,"span",60),i(9),t()(),n(10,"td",61),i(11),t(),n(12,"td",62),i(13),t(),n(14,"td",63),i(15),t(),n(16,"td",64),i(17),t(),n(18,"td",65)(19,"button",66),f("click",function(){let o=x(e).$implicit,d=g();return C(d.viewEsimDetails(o))}),p(20,"i",67),t()()()}if(r&2){let e=m.$implicit,s=g();a(2),u(e.id),a(2),u(e.iccid||"Non sp\xE9cifi\xE9"),a(2),u(e.activation_code||"Non sp\xE9cifi\xE9"),a(2),j(s.getStatusClass(e.status||"unknown")),a(),_(" ",s.formatStatus(e.status||"unknown")," "),a(2),u(s.formatDestination(e.destination||"unknown")),a(2),u(s.formatDataLimit(e.data_limit)),a(2),_("",e.validity_days||"Non sp\xE9cifi\xE9"," jours"),a(2),u(s.formatPrice(e.price,e.currency))}}function xn(r,m){r&1&&(n(0,"div",77),p(1,"i",78),i(2," Chargement des d\xE9tails... "),t())}function Cn(r,m){if(r&1){let e=y();n(0,"button",91),f("click",function(){x(e);let o=g(3);return C(o.generateQrCode())}),p(1,"i",92),i(2," G\xE9n\xE9rer QR Code "),t()}}function bn(r,m){if(r&1){let e=y();n(0,"button",66),f("click",function(){x(e);let o=g(3);return C(o.copyLpaCode())}),p(1,"i",93),i(2," Copier Code "),t()}}function vn(r,m){if(r&1){let e=y();n(0,"div",94)(1,"strong"),i(2,"QR Code d'activation:"),t(),n(3,"div",95),p(4,"img",96),n(5,"div",97)(6,"p",98),p(7,"i",99),i(8," Scannez ce QR code avec votre t\xE9l\xE9phone pour activer automatiquement l'eSIM "),t(),n(9,"button",100),f("click",function(){x(e);let o=g(3);return C(o.hideQrCode())}),p(10,"i",72),i(11," Masquer QR Code "),t()()()()}if(r&2){let e=g(3);a(4),c("src",e.qrCodeUrl,Pe)}}function Mn(r,m){if(r&1&&(n(0,"div",80)(1,"h3"),i(2,"Politique de R\xE9utilisation"),t(),n(3,"div",81)(4,"div",82)(5,"strong"),i(6,"Type de r\xE9utilisation:"),t(),n(7,"span"),i(8),t()(),n(9,"div",82)(10,"strong"),i(11,"Nombre maximum:"),t(),n(12,"span"),i(13),t()()()()),r&2){let e=g(3);a(8),u(e.getProfileReusePolicy().reuse_type||"Non sp\xE9cifi\xE9"),a(5),u(e.getProfileReusePolicy().max_count||"Non sp\xE9cifi\xE9")}}function yn(r,m){if(r&1&&(n(0,"div",82)(1,"strong"),i(2),t(),n(3,"span"),i(4),t()()),r&2){let e=m.$implicit;a(2),_("IMSI ",e.type||"Principal",":"),a(2),u(e.imsi||"Non disponible")}}function En(r,m){if(r&1&&(n(0,"div",80)(1,"h3"),i(2,"IMSI"),t(),n(3,"div",81),h(4,yn,5,2,"div",101),t()()),r&2){let e=g(3);a(4),c("ngForOf",e.esimDetails.imsis)}}function Sn(r,m){if(r&1&&(n(0,"div",79)(1,"div",80)(2,"h3"),i(3,"Informations G\xE9n\xE9rales"),t(),n(4,"div",81)(5,"div",82)(6,"strong"),i(7,"ICCID:"),t(),n(8,"span"),i(9),t()(),n(10,"div",82)(11,"strong"),i(12,"Statut:"),t(),n(13,"span",60),i(14),t()(),n(15,"div",82)(16,"strong"),i(17,"Date de cr\xE9ation:"),t(),n(18,"span"),i(19),t()(),n(20,"div",82)(21,"strong"),i(22,"Entreprise:"),t(),n(23,"span"),i(24),t()()()(),n(25,"div",80)(26,"h3"),i(27,"Profil EUICC"),t(),n(28,"div",81)(29,"div",82)(30,"strong"),i(31,"\xC9tat:"),t(),n(32,"span",60),i(33),t()(),n(34,"div",82)(35,"strong"),i(36,"Derni\xE8re op\xE9ration:"),t(),n(37,"span"),i(38),t()(),n(39,"div",82)(40,"strong"),i(41,"Code d'activation:"),t(),n(42,"span",83),i(43),t()(),n(44,"div",82)(45,"strong"),i(46,"Actions:"),t(),n(47,"div",84),h(48,Cn,3,0,"button",85)(49,bn,3,0,"button",86),t()(),h(50,vn,12,1,"div",87),n(51,"div",82)(52,"strong"),i(53,"R\xE9utilisations restantes:"),t(),n(54,"span"),i(55),t()(),n(56,"div",82)(57,"strong"),i(58,"R\xE9utilisation activ\xE9e:"),t(),n(59,"span"),i(60),t()(),n(61,"div",82)(62,"strong"),i(63,"Code de confirmation requis:"),t(),n(64,"span"),i(65),t()(),n(66,"div",82)(67,"strong"),i(68,"Date de lib\xE9ration:"),t(),n(69,"span"),i(70),t()(),n(71,"div",82)(72,"strong"),i(73,"EID:"),t(),n(74,"span",88),i(75),t()(),n(76,"div",82)(77,"strong"),i(78,"IMSI:"),t(),n(79,"span"),i(80),t()()()(),h(81,Mn,14,2,"div",89)(82,En,5,1,"div",89),n(83,"div",80)(84,"h3"),i(85,"Donn\xE9es Compl\xE8tes"),t(),n(86,"div",90)(87,"pre"),i(88),t()()()()),r&2){let e=g(2);a(9),u(e.esimDetails.iccid||"Non disponible"),a(4),j(e.getStatusClass(e.esimDetails.sim_status)),a(),_(" ",e.formatStatus(e.esimDetails.sim_status)," "),a(5),u(e.formatDate(e.esimDetails.created_date)),a(5),u(e.esimDetails.company||"Non disponible"),a(8),j(e.getEuiccStateClass(e.getEuiccState())),a(),_(" ",e.getEuiccState()," "),a(5),u(e.getLastOperationDate()),a(5),u(e.getLpaCode()),a(5),c("ngIf",e.getLpaCode()!=="Non disponible"),a(),c("ngIf",e.getLpaCode()!=="Non disponible"),a(),c("ngIf",e.showQrCode),a(5),u(e.getReuseRemainingCount()),a(5),u(e.getReuseEnabled()),a(5),u(e.getCcRequired()),a(5),u(e.getReleaseDate()),a(5),u(e.getEid()),a(5),u(e.getImsi()),a(),c("ngIf",e.getProfileReusePolicy()),a(),c("ngIf",e.esimDetails.imsis&&e.esimDetails.imsis.length>0),a(6),u(e.JSON.stringify(e.esimDetails,null,2))}}function Pn(r,m){r&1&&(n(0,"div",102),p(1,"i",53),i(2," Impossible de r\xE9cup\xE9rer les d\xE9tails de cette eSIM "),t())}function wn(r,m){if(r&1){let e=y();n(0,"div",68),f("click",function(){x(e);let o=g();return C(o.closeDetailsModal())}),n(1,"div",69),f("click",function(o){return x(e),C(o.stopPropagation())}),n(2,"div",70)(3,"h2"),i(4),t(),n(5,"button",71),f("click",function(){x(e);let o=g();return C(o.closeDetailsModal())}),p(6,"i",72),t()(),n(7,"div",73),h(8,xn,3,0,"div",74)(9,Sn,89,23,"div",75)(10,Pn,3,0,"div",76),t()()()}if(r&2){let e=g();a(4),_("D\xE9tails eSIM - ",e.selectedEsim==null?null:e.selectedEsim.iccid,""),a(4),c("ngIf",e.loadingDetails),a(),c("ngIf",!e.loadingDetails&&e.esimDetails),a(),c("ngIf",!e.loadingDetails&&!e.esimDetails)}}var ot=(()=>{class r{get esimStatusFilter(){return this._esimStatusFilter}set esimStatusFilter(e){this._esimStatusFilter=e,this.currentPage=1}get packageDestinationFilter(){return this._packageDestinationFilter}set packageDestinationFilter(e){this._packageDestinationFilter=e,this.currentPage=1}constructor(e,s){this.consoleConnectService=e,this.esimService=s,this.esims=[],this.packages=[],this.loading=!1,this.error="",this.success="",this.stockStats={},this.loadingStockStats=!1,this._esimStatusFilter="",this._packageDestinationFilter="",this.currentPage=1,this.itemsPerPage=20,this.stats={},this.apiInfo={},this.showDetailsModal=!1,this.selectedEsim=null,this.esimDetails=null,this.loadingDetails=!1,this.showQrCode=!1,this.qrCodeData="",this.qrCodeUrl="",this.JSON=JSON}ngOnInit(){this.loadData(),this.loadStockStats()}loadStockStats(){this.loadingStockStats=!0,this.esimService.getEsimStockStats().subscribe({next:e=>{e.success&&(this.stockStats=e.stats),this.loadingStockStats=!1},error:e=>{console.error("Erreur lors du chargement des statistiques du stock:",e),this.loadingStockStats=!1}})}loadData(){this.loading=!0,this.error="",this.success="",this.consoleConnectService.getEsimsFromConsoleConnect().subscribe({next:e=>{this.esims=e.esims||[],this.packages=e.packages||[],this.stats=e.stats||{},this.apiInfo=e.api_info||{},this.success=`Donn\xE9es charg\xE9es avec succ\xE8s: ${this.esims.length} eSIMs, ${this.packages.length} packages`,this.loading=!1},error:e=>{this.error=`Erreur lors du chargement: ${e.message}`,this.loading=!1}})}refreshData(){this.currentPage=1,this.loadData(),this.loadStockStats()}getStatusItems(){return this.stockStats?.by_status?Object.entries(this.stockStats.by_status).map(([e,s])=>({key:e,value:s.count||0})):[]}get paginatedEsims(){let e=this.esims.filter(l=>!this.esimStatusFilter||l.status&&l.status.toLowerCase().includes(this.esimStatusFilter.toLowerCase())),s=(this.currentPage-1)*this.itemsPerPage,o=s+this.itemsPerPage,d=e.slice(s,o);return console.log("[paginatedEsims] page",this.currentPage,"/",this.totalPages,"| ICCID:",d.map(l=>l.iccid)),d}get paginatedPackages(){let e=this.packages.filter(d=>!this.packageDestinationFilter||d.destination&&d.destination.toLowerCase().includes(this.packageDestinationFilter.toLowerCase())),s=(this.currentPage-1)*this.itemsPerPage,o=s+this.itemsPerPage;return e.slice(s,o)}get totalPages(){let e=this.esims.filter(s=>!this.esimStatusFilter||s.status&&s.status.toLowerCase().includes(this.esimStatusFilter.toLowerCase()));return Math.ceil(e.length/this.itemsPerPage)}changePage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e,console.log("Page chang\xE9e:",this.currentPage,"eSIMs affich\xE9es:",this.paginatedEsims.map(s=>s.iccid)))}formatStatus(e){return{active:"Actif",inactive:"Inactif",pending:"En attente",expired:"Expir\xE9",unknown:"Inconnu"}[e]||e}formatDestination(e){return{europe:"Europe",asia:"Asie",america:"Am\xE9rique",africa:"Afrique",global:"Global",unknown:"Inconnu"}[e]||e}formatDataLimit(e){return e?typeof e=="number"?`${e} MB`:e.toString():"Non sp\xE9cifi\xE9"}formatPrice(e,s="EUR"){return e?`${e} ${s}`:"Non sp\xE9cifi\xE9"}formatDate(e){return e?new Date(e).toLocaleString("fr-FR"):"Non sp\xE9cifi\xE9"}getStatusClass(e){return{active:"status-active",inactive:"status-inactive",pending:"status-pending",expired:"status-expired",unknown:"status-unknown"}[e]||"status-unknown"}getEuiccStateClass(e){return{enabled:"status-active",disabled:"status-disabled",active:"status-active",inactive:"status-inactive",pending:"status-pending",expired:"status-expired",unknown:"status-unknown"}[e.toLowerCase()]||"status-unknown"}viewEsimDetails(e){this.selectedEsim=e,this.showDetailsModal=!0,this.loadingDetails=!0,this.esimDetails=null,this.consoleConnectService.getEsimDetails(e.id).subscribe({next:s=>{this.esimDetails=s.esim||s,this.loadingDetails=!1,console.log("D\xE9tails eSIM r\xE9cup\xE9r\xE9s:",this.esimDetails)},error:s=>{console.error("Erreur lors de la r\xE9cup\xE9ration des d\xE9tails:",s),this.loadingDetails=!1,this.esimDetails=null}})}closeDetailsModal(){this.showDetailsModal=!1,this.selectedEsim=null,this.esimDetails=null}getLpaCode(){return this.esimDetails&&this.esimDetails.activation_code||"Non disponible"}getEuiccState(){return this.esimDetails&&this.esimDetails.state||"Non disponible"}getLastOperationDate(){return this.esimDetails?this.esimDetails.last_operation_date_formatted?this.esimDetails.last_operation_date_formatted:this.esimDetails.last_operation_date?new Date(this.esimDetails.last_operation_date).toLocaleString("fr-FR"):"Non disponible":"Non disponible"}getReuseRemainingCount(){return this.esimDetails&&this.esimDetails.reuse_remaining_count!==void 0?this.esimDetails.reuse_remaining_count.toString():"Non disponible"}getEid(){return this.esimDetails&&this.esimDetails.eid||"Non disponible"}getImsi(){return this.esimDetails&&this.esimDetails.imsi||"Non disponible"}getReuseEnabled(){return this.esimDetails?this.esimDetails.reuse_enabled?"Oui":"Non":"Non disponible"}getCcRequired(){return this.esimDetails?this.esimDetails.cc_required?"Oui":"Non":"Non disponible"}getReleaseDate(){return this.esimDetails?this.esimDetails.release_date_formatted?this.esimDetails.release_date_formatted:this.esimDetails.release_date?new Date(this.esimDetails.release_date).toLocaleString("fr-FR"):"Non disponible":"Non disponible"}getProfileReusePolicy(){return this.esimDetails&&this.esimDetails.profile_reuse_policy||null}viewPackageDetails(e){console.log("D\xE9tails package:",e)}generateQrCode(){let e=this.getLpaCode();e&&e!=="Non disponible"&&(this.qrCodeData=e,this.qrCodeUrl=`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(e)}`,this.showQrCode=!0)}hideQrCode(){this.showQrCode=!1,this.qrCodeData="",this.qrCodeUrl=""}copyLpaCode(){let e=this.getLpaCode();e&&e!=="Non disponible"&&navigator.clipboard.writeText(e).then(()=>{console.log("Code LPA copi\xE9 dans le presse-papiers")})}get filteredEsimsCount(){return this.esims.filter(e=>!this.esimStatusFilter||e.status&&e.status.toLowerCase().includes(this.esimStatusFilter.toLowerCase())).length}get paginatedEsimsIccids(){return this.paginatedEsims.map(e=>e.iccid).join(", ")}static{this.\u0275fac=function(s){return new(s||r)(E(it),E(Q))}}static{this.\u0275cmp=S({type:r,selectors:[["app-console-connect"]],decls:52,vars:13,consts:[[1,"console-connect-container"],[1,"header"],[1,"header-content"],[1,"title"],[1,"fas","fa-satellite-dish"],[1,"subtitle"],[1,"header-actions"],[1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-sync-alt"],["class","stock-stats-section",4,"ngIf"],["class","messages",4,"ngIf"],[1,"tab-content"],[1,"filters"],[1,"filter-group"],["for","statusFilter"],["type","text","id","statusFilter","placeholder","Rechercher par statut...",1,"filter-input",3,"ngModelChange","ngModel"],[1,"table-container"],[1,"data-table"],["class","table-row",4,"ngFor","ngForOf"],[2,"margin","2rem 0","text-align","center"],[2,"font-size","2rem","background","orange","color","white","margin","0 2rem",3,"click","disabled"],[2,"font-size","1.5rem","color","#2563eb"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"stock-stats-section"],[1,"stats-header"],[1,"fas","fa-chart-bar"],["class","last-sync",4,"ngIf"],[1,"stats-grid"],[1,"stat-card","total"],[1,"stat-icon"],[1,"fas","fa-sim-card"],[1,"stat-content"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","available"],[1,"fas","fa-check-circle"],[1,"stat-card","used"],[1,"fas","fa-user-check"],[1,"stat-card","disabled"],[1,"fas","fa-ban"],["class","status-details",4,"ngIf"],[1,"last-sync"],[1,"fas","fa-clock"],[1,"status-details"],[1,"status-grid"],["class","status-item",4,"ngFor","ngForOf"],[1,"status-item"],[1,"status-name"],[1,"status-count"],[1,"messages"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle"],[1,"alert","alert-success"],[1,"table-row"],[1,"id-cell"],[1,"iccid-cell"],[1,"activation-cell"],[1,"status-cell"],[1,"status-badge"],[1,"destination-cell"],[1,"data-cell"],[1,"validity-cell"],[1,"price-cell"],[1,"actions-cell"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"fas","fa-eye"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"fas","fa-times"],[1,"modal-body"],["class","loading",4,"ngIf"],["class","esim-details",4,"ngIf"],["class","error",4,"ngIf"],[1,"loading"],[1,"fas","fa-spinner","fa-spin"],[1,"esim-details"],[1,"detail-section"],[1,"detail-grid"],[1,"detail-item"],[1,"lpa-code"],[1,"action-buttons"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["class","btn btn-sm btn-info",3,"click",4,"ngIf"],["class","detail-item qr-code-section",4,"ngIf"],[1,"eid-code"],["class","detail-section",4,"ngIf"],[1,"raw-data"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-qrcode"],[1,"fas","fa-copy"],[1,"detail-item","qr-code-section"],[1,"qr-code-container"],["alt","QR Code d'activation",1,"qr-code-image",3,"src"],[1,"qr-code-info"],[1,"qr-instructions"],[1,"fas","fa-info-circle"],[1,"btn","btn-sm","btn-secondary",3,"click"],["class","detail-item",4,"ngFor","ngForOf"],[1,"error"]],template:function(s,o){s&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),p(4,"i",4),i(5," Console Connect - Donn\xE9es Directes "),t(),n(6,"p",5),i(7,"Affichage des donn\xE9es brutes de l'API Console Connect"),t()(),n(8,"div",6)(9,"button",7),f("click",function(){return o.refreshData()}),p(10,"i",8),i(11),t()()(),h(12,gn,40,6,"div",9)(13,_n,3,2,"div",10),n(14,"div",11)(15,"div",12)(16,"div",13)(17,"label",14),i(18,"Filtrer par statut:"),t(),n(19,"input",15),M("ngModelChange",function(l){return v(o.esimStatusFilter,l)||(o.esimStatusFilter=l),l}),t()()(),n(20,"div",16)(21,"table",17)(22,"thead")(23,"tr")(24,"th"),i(25,"ID"),t(),n(26,"th"),i(27,"ICCID"),t(),n(28,"th"),i(29,"Code Activation"),t(),n(30,"th"),i(31,"Statut"),t(),n(32,"th"),i(33,"Destination"),t(),n(34,"th"),i(35,"Donn\xE9es"),t(),n(36,"th"),i(37,"Validit\xE9"),t(),n(38,"th"),i(39,"Prix"),t(),n(40,"th"),i(41,"Actions"),t()()(),n(42,"tbody"),h(43,hn,21,10,"tr",18),t()()(),n(44,"div",19)(45,"button",20),f("click",function(){return o.changePage(o.currentPage-1)}),i(46,"\u2B05\uFE0F"),t(),n(47,"span",21),i(48),t(),n(49,"button",20),f("click",function(){return o.changePage(o.currentPage+1)}),i(50,"\u27A1\uFE0F"),t()()()(),h(51,wn,11,4,"div",22)),s&2&&(a(9),c("disabled",o.loading),a(),pe("fa-spin",o.loading),a(),_(" ",o.loading?"Chargement...":"Actualiser"," "),a(),c("ngIf",o.stockStats),a(),c("ngIf",o.error||o.success),a(6),b("ngModel",o.esimStatusFilter),a(24),c("ngForOf",o.paginatedEsims),a(2),c("disabled",o.currentPage===1),a(3),W("Page ",o.currentPage," / ",o.totalPages,""),a(),c("disabled",o.currentPage===o.totalPages),a(2),c("ngIf",o.showDetailsModal))},dependencies:[L,w,T,F,V,B],styles:[".console-connect-container[_ngcontent-%COMP%]{padding:2rem;background:#f8fafc;min-height:100vh}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding:1.5rem;background:#fff;border-radius:12px;box-shadow:0 2px 10px #0000001a}.header-content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#1e293b;margin:0;display:flex;align-items:center;gap:.5rem}.header-content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#3b82f6}.header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#64748b;margin:.5rem 0 0;font-size:.95rem}.header-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border-radius:8px;font-weight:600;transition:all .2s}.messages[_ngcontent-%COMP%]{margin-bottom:1.5rem}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}.alert-danger[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert-success[_ngcontent-%COMP%]{background:#f0fdf4;color:#16a34a;border:1px solid #bbf7d0}.tabs[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:2rem;background:#fff;padding:.5rem;border-radius:12px;box-shadow:0 2px 10px #0000001a}.tab-btn[_ngcontent-%COMP%]{flex:1;padding:1rem;border:none;background:transparent;border-radius:8px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:.5rem;font-weight:600;color:#64748b}.tab-btn[_ngcontent-%COMP%]:hover{background:#f1f5f9;color:#3b82f6}.tab-btn.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.tab-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.tab-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 10px #0000001a;overflow:hidden}.tab-pane[_ngcontent-%COMP%]{padding:2rem}.filters[_ngcontent-%COMP%]{margin-bottom:2rem;padding:1.5rem;background:#f8fafc;border-radius:8px}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#374151;font-size:.9rem}.filter-input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.95rem;transition:border-color .2s}.filter-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.table-container[_ngcontent-%COMP%]{overflow-x:auto;border-radius:8px;border:1px solid #e5e7eb}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.9rem}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;padding:1rem;text-align:left;font-weight:600;color:#374151;border-bottom:1px solid #e5e7eb}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #f3f4f6;vertical-align:middle}.table-row[_ngcontent-%COMP%]:hover{background:#f9fafb}.id-cell[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-size:.85rem;color:#6b7280}.iccid-cell[_ngcontent-%COMP%], .activation-cell[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-size:.85rem;word-break:break-all}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.8rem;font-weight:600;text-transform:uppercase}.destination-cell[_ngcontent-%COMP%]{font-weight:600;color:#1f2937}.data-cell[_ngcontent-%COMP%], .validity-cell[_ngcontent-%COMP%]{font-weight:500;color:#374151}.price-cell[_ngcontent-%COMP%]{font-weight:700;color:#059669}.description-cell[_ngcontent-%COMP%]{max-width:200px;word-wrap:break-word}.actions-cell[_ngcontent-%COMP%]{text-align:center}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:all .2s;display:inline-flex;align-items:center;gap:.5rem;text-decoration:none}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-info[_ngcontent-%COMP%]{background:#06b6d4;color:#fff}.btn-info[_ngcontent-%COMP%]:hover{background:#0891b2}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1rem;margin-top:2rem;padding:1rem;background:#f9fafb;border-radius:8px}.page-info[_ngcontent-%COMP%]{font-weight:600;color:#374151}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;margin-bottom:3rem}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:2rem;border-radius:12px;display:flex;align-items:center;gap:1rem;box-shadow:0 4px 15px #0000001a}.stat-icon[_ngcontent-%COMP%]{font-size:2rem;opacity:.8}.stat-content[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0}.stat-content[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{margin:.25rem 0 0;opacity:.9;font-size:.9rem}.chart-section[_ngcontent-%COMP%]{margin-bottom:3rem}.chart-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#1f2937;margin-bottom:1.5rem;font-size:1.25rem}.chart-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;border:1px solid #e5e7eb}.chart-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1rem;padding:.75rem;border-radius:6px;background:#f9fafb}.chart-bar[_ngcontent-%COMP%]{flex:1;height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden}.bar-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#3b82f6,#1d4ed8);border-radius:4px;transition:width .3s ease}.chart-label[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;min-width:200px}.label-text[_ngcontent-%COMP%]{font-weight:600;color:#374151}.label-value[_ngcontent-%COMP%]{font-weight:700;color:#1f2937;background:#e0e7ff;padding:.25rem .5rem;border-radius:4px;font-size:.8rem}.api-info-section[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;border:1px solid #e5e7eb}.api-info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#1f2937;margin-bottom:1rem;font-size:1.25rem}.info-grid[_ngcontent-%COMP%]{display:grid;gap:1rem}.info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#f9fafb;border-radius:6px}.info-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#374151;font-weight:600}.info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1f2937;font-weight:500}@media (max-width: 768px){.console-connect-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.tabs[_ngcontent-%COMP%]{flex-direction:column}.tab-btn[_ngcontent-%COMP%]{justify-content:flex-start}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.chart-label[_ngcontent-%COMP%], .info-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem}}.fa-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fa-spin 1s infinite linear}@keyframes _ngcontent-%COMP%_fa-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 4px 20px #00000026;max-width:800px;width:90%;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e5e7eb;background:#f9fafb;border-radius:8px 8px 0 0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:1.25rem;font-weight:600}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;color:#6b7280;cursor:pointer;padding:5px;border-radius:4px;transition:all .2s}.modal-close[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.modal-body[_ngcontent-%COMP%]{padding:20px}.loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:40px;color:#6b7280;font-size:1.1rem}.loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;color:#3b82f6}.esim-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.detail-section[_ngcontent-%COMP%]{background:#f9fafb;border-radius:8px;padding:20px;border:1px solid #e5e7eb}.detail-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 15px;color:#1f2937;font-size:1.1rem;font-weight:600;border-bottom:2px solid #3b82f6;padding-bottom:8px}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:15px}.detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#fff;border-radius:6px;border:1px solid #e5e7eb}.detail-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#374151;font-weight:600;min-width:150px}.detail-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1f2937;font-family:Courier New,monospace;word-break:break-all}.lpa-code[_ngcontent-%COMP%], .eid-code[_ngcontent-%COMP%]{background:#f3f4f6;padding:4px 8px;border-radius:4px;font-family:Courier New,monospace;font-size:.9rem;color:#1f2937;border:1px solid #d1d5db}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;font-size:.875rem;font-weight:500}.status-badge.status-active[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.status-badge.status-inactive[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.status-badge.status-pending[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-badge.status-expired[_ngcontent-%COMP%], .status-badge.status-disabled[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.status-badge.status-enabled[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.raw-data[_ngcontent-%COMP%]{background:#1f2937;color:#f9fafb;padding:15px;border-radius:6px;overflow-x:auto;font-family:Courier New,monospace;font-size:.875rem;max-height:300px;overflow-y:auto}.raw-data[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;white-space:pre-wrap}.error[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:40px;color:#dc2626;font-size:1.1rem}.error[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap}.btn-secondary[_ngcontent-%COMP%]{background:#6b7280;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background:#4b5563}.qr-code-section[_ngcontent-%COMP%]{grid-column:1 / -1;margin-top:1rem}.qr-code-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:1rem;background:#f9fafb;border-radius:8px;border:2px dashed #d1d5db}.qr-code-image[_ngcontent-%COMP%]{max-width:300px;height:auto;border-radius:8px;box-shadow:0 4px 15px #0000001a}.qr-code-info[_ngcontent-%COMP%]{text-align:center;max-width:400px}.qr-instructions[_ngcontent-%COMP%]{color:#374151;font-size:.9rem;margin-bottom:1rem;line-height:1.5}.qr-instructions[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#3b82f6;margin-right:.5rem}"]})}}return r})();var at=(()=>{class r{constructor(e){this.http=e}createTemplate(e){return this.http.post(`${k}admin/package-templates`,e)}getTemplates(){return this.http.get(`${k}admin/package-templates`)}static{this.\u0275fac=function(s){return new(s||r)(R(U))}}static{this.\u0275prov=q({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function On(r,m){if(r&1&&(n(0,"div",32),p(1,"i",33),i(2),t()),r&2){let e=g(2);a(2),_(" ",e.success," ")}}function In(r,m){if(r&1&&(n(0,"div",34),p(1,"i",35),i(2),t()),r&2){let e=g(2);a(2),_(" ",e.error," ")}}function Dn(r,m){if(r&1&&(n(0,"div",29),h(1,On,3,1,"div",30)(2,In,3,1,"div",31),t()),r&2){let e=g();a(),c("ngIf",e.success),a(),c("ngIf",e.error)}}function An(r,m){r&1&&(n(0,"div",36),i(1,"Nom requis"),t())}function Tn(r,m){r&1&&(n(0,"div",36),i(1,"Valeur requise > 0"),t())}function Fn(r,m){r&1&&(n(0,"div",36),i(1,"Valeur requise > 0"),t())}function Nn(r,m){r&1&&(n(0,"div",36),i(1,"Date requise"),t())}function Ln(r,m){r&1&&(n(0,"div",36),i(1,"Date requise"),t())}function Vn(r,m){r&1&&(n(0,"div",36),i(1,"Date requise"),t())}function zn(r,m){r&1&&(n(0,"div",36),i(1,"Au moins un pays requis"),t())}function Wn(r,m){r&1&&(n(0,"div",36),i(1,"Dur\xE9e requise > 0"),t())}function jn(r,m){r&1&&p(0,"i",37)}var rt=(()=>{class r{constructor(e,s){this.fb=e,this.templateService=s,this.loading=!1,this.success="",this.error="",this.DEFAULT_INVENTORY_ID=50580,this.DEFAULT_TRAFFIC_POLICY_ID=789,this.templateForm=this.fb.group({name:["",O.required],notes:[""],activation_type:["MANUAL",O.required],data_usage_allowance:[null,[O.required,O.min(1)]],data_unit:["GB",O.required],voice_usage_allowance:[0,[O.min(0)]],sms_usage_allowance:[0,[O.min(0)]],activation_time_allowance:[null,[O.required,O.min(1)]],earliest_activation_date:[null,O.required],earliest_available_date:[null,O.required],latest_available_date:[null,O.required],supported_countries:[[],O.required],time_allowance_unit:["CALENDAR_MONTH",O.required],time_allowance_duration:[1,[O.required,O.min(1)]]})}get f(){return this.templateForm.controls}toTimestampMs(e){return e?new Date(e).getTime():0}toBytes(e,s){let o=e;return s==="GB"?o=e*1024*1024*1024:s==="MB"&&(o=e*1024*1024),console.log(`[FRONT] Conversion data: ${e} ${s} = ${o} octets`),o}onSubmit(){if(this.templateForm.invalid){this.templateForm.markAllAsTouched();return}this.loading=!0,this.success="",this.error="";let e=this.templateForm.value,s=this.toBytes(e.data_usage_allowance,e.data_unit),o={name:e.name,notes:e.notes,activation_type:e.activation_type,data_usage_allowance:s,voice_usage_allowance:e.voice_usage_allowance,sms_usage_allowance:e.sms_usage_allowance,activation_time_allowance:e.activation_time_allowance,earliest_activation_date:this.toTimestampMs(e.earliest_activation_date),earliest_available_date:this.toTimestampMs(e.earliest_available_date),latest_available_date:this.toTimestampMs(e.latest_available_date),supported_countries:e.supported_countries.split(",").map(d=>d.trim()),traffic_policy:this.DEFAULT_TRAFFIC_POLICY_ID,time_allowance:{unit:e.time_allowance_unit,duration:e.time_allowance_duration},inventory:this.DEFAULT_INVENTORY_ID};console.log("[FRONT] Payload envoy\xE9 au backend:",o),this.templateService.createTemplate(o).subscribe({next:d=>{this.loading=!1,console.log("[FRONT] R\xE9ponse succ\xE8s backend:",d),d.success?(this.success="Template cr\xE9\xE9 avec succ\xE8s !",this.templateForm.reset()):this.error=d.message||"Erreur lors de la cr\xE9ation du template"},error:d=>{this.loading=!1,console.error("[FRONT] Erreur cr\xE9ation template:",d),d.error&&d.error.message?this.error="Erreur backend : "+d.error.message:d.status===400&&d.error?this.error="Erreur 400 : "+JSON.stringify(d.error):this.error="Erreur de connexion au serveur"}})}static{this.\u0275fac=function(s){return new(s||r)(E(je),E(at))}}static{this.\u0275cmp=S({type:r,selectors:[["app-admin-template-create"]],standalone:!0,features:[P],decls:84,vars:13,consts:[[1,"template-create-container"],["class","messages",4,"ngIf"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","name"],["class","error",4,"ngIf"],["formControlName","notes"],["formControlName","activation_type"],["value","MANUAL"],["value","AUTO"],[2,"display","flex","gap","8px","align-items","center"],["type","number","formControlName","data_usage_allowance","min","1",2,"flex","2"],["formControlName","data_unit",2,"flex","1"],["value","GB"],["value","MB"],["type","number","formControlName","voice_usage_allowance","min","0"],["type","number","formControlName","sms_usage_allowance","min","0"],["type","number","formControlName","activation_time_allowance","min","1"],["type","datetime-local","formControlName","earliest_activation_date"],["type","datetime-local","formControlName","earliest_available_date"],["type","datetime-local","formControlName","latest_available_date"],["type","text","formControlName","supported_countries","placeholder","Ex: FRA,SEN,DEU"],["formControlName","time_allowance_unit"],["value","CALENDAR_MONTH"],["value","DAY"],["value","HOUR"],["type","number","formControlName","time_allowance_duration","min","1"],["type","submit",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],[1,"messages"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-success"],[1,"fas","fa-check-circle"],[1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle"],[1,"error"],[1,"fas","fa-spinner","fa-spin"]],template:function(s,o){s&1&&(n(0,"div",0)(1,"h2"),i(2,"Cr\xE9er un nouveau template de package eSIM"),t(),h(3,Dn,3,2,"div",1),n(4,"form",2),f("ngSubmit",function(){return o.onSubmit()}),n(5,"div",3)(6,"label"),i(7,"Nom du template *"),t(),p(8,"input",4),h(9,An,2,0,"div",5),t(),n(10,"div",3)(11,"label"),i(12,"Notes"),t(),p(13,"textarea",6),t(),n(14,"div",3)(15,"label"),i(16,"Type d'activation *"),t(),n(17,"select",7)(18,"option",8),i(19,"Manuelle"),t(),n(20,"option",9),i(21,"Automatique"),t()()(),n(22,"div",3)(23,"label"),i(24,"Data *"),t(),n(25,"div",10),p(26,"input",11),n(27,"select",12)(28,"option",13),i(29,"Go"),t(),n(30,"option",14),i(31,"Mo"),t()()(),h(32,Tn,2,0,"div",5),t(),n(33,"div",3)(34,"label"),i(35,"Voix (minutes)"),t(),p(36,"input",15),t(),n(37,"div",3)(38,"label"),i(39,"SMS"),t(),p(40,"input",16),t(),n(41,"div",3)(42,"label"),i(43,"Validit\xE9 (secondes) *"),t(),p(44,"input",17),h(45,Fn,2,0,"div",5),t(),n(46,"div",3)(47,"label"),i(48,"Date d'activation la plus t\xF4t *"),t(),p(49,"input",18),h(50,Nn,2,0,"div",5),t(),n(51,"div",3)(52,"label"),i(53,"Date de disponibilit\xE9 la plus t\xF4t *"),t(),p(54,"input",19),h(55,Ln,2,0,"div",5),t(),n(56,"div",3)(57,"label"),i(58,"Date de disponibilit\xE9 la plus tard *"),t(),p(59,"input",20),h(60,Vn,2,0,"div",5),t(),n(61,"div",3)(62,"label"),i(63,"Pays support\xE9s (codes ISO, s\xE9par\xE9s par virgule, ex: FRA,SEN,DEU)"),t(),p(64,"input",21),h(65,zn,2,0,"div",5),t(),n(66,"div",3)(67,"label"),i(68,"Validit\xE9 (unit\xE9) *"),t(),n(69,"select",22)(70,"option",23),i(71,"Mois calendaire"),t(),n(72,"option",24),i(73,"Jour"),t(),n(74,"option",25),i(75,"Heure"),t()()(),n(76,"div",3)(77,"label"),i(78,"Validit\xE9 (dur\xE9e) *"),t(),p(79,"input",26),h(80,Wn,2,0,"div",5),t(),n(81,"button",27),h(82,jn,1,0,"i",28),i(83),t()()()),s&2&&(a(3),c("ngIf",o.success||o.error),a(),c("formGroup",o.templateForm),a(5),c("ngIf",o.f.name.touched&&o.f.name.invalid),a(23),c("ngIf",o.f.data_usage_allowance.touched&&o.f.data_usage_allowance.invalid),a(13),c("ngIf",o.f.activation_time_allowance.touched&&o.f.activation_time_allowance.invalid),a(5),c("ngIf",o.f.earliest_activation_date.touched&&o.f.earliest_activation_date.invalid),a(5),c("ngIf",o.f.earliest_available_date.touched&&o.f.earliest_available_date.invalid),a(5),c("ngIf",o.f.latest_available_date.touched&&o.f.latest_available_date.invalid),a(5),c("ngIf",o.f.supported_countries.touched&&o.f.supported_countries.invalid),a(15),c("ngIf",o.f.time_allowance_duration.touched&&o.f.time_allowance_duration.invalid),a(),c("disabled",o.templateForm.invalid||o.loading),a(),c("ngIf",o.loading),a(),_(" ",o.loading?"Cr\xE9ation en cours...":"Cr\xE9er le template"," "))},dependencies:[he,K,H,Y,T,Z,G,F,X,$,Le,Ve,A,w,Ie],styles:["[_ngcontent-%COMP%]:root{--primary: #1976d2;--primary-light: #63a4ff;--primary-dark: #004ba0;--accent: #ffb300;--bg: #f5f7fa;--card-bg: #fff;--error: #e53935;--success: #43a047;--shadow: 0 8px 32px 0 rgba(31, 38, 135, .15)}body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{background:var(--bg)}.template-create-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;background:var(--bg);padding-top:40px;animation:_ngcontent-%COMP%_fadeIn .8s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}.template-create-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary-dark);font-weight:700;margin-bottom:24px;letter-spacing:1px;text-align:center}form[_ngcontent-%COMP%]{background:var(--card-bg);box-shadow:var(--shadow);border-radius:18px;padding:36px 32px 28px;min-width:340px;max-width:420px;width:100%;display:flex;flex-direction:column;gap:18px;animation:_ngcontent-%COMP%_cardAppear .7s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_cardAppear{0%{opacity:0;transform:scale(.97)}to{opacity:1;transform:scale(1)}}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:8px}label[_ngcontent-%COMP%]{font-size:1rem;color:#333;font-weight:500;margin-bottom:6px;display:block;transition:color .2s}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:12px 14px;border:1.5px solid #e0e0e0;border-radius:8px;font-size:1rem;background:#fafbfc;color:#222;outline:none;transition:border-color .2s,box-shadow .2s;box-shadow:none;margin-top:2px}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 2px var(--primary-light);background:#fff}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}textarea[_ngcontent-%COMP%]{min-height:60px;resize:vertical}.error[_ngcontent-%COMP%]{color:var(--error);font-size:.92em;margin-top:2px;animation:_ngcontent-%COMP%_shake .3s}@keyframes _ngcontent-%COMP%_shake{10%,90%{transform:translate(-2px)}20%,80%{transform:translate(4px)}30%,50%,70%{transform:translate(-8px)}40%,60%{transform:translate(8px)}}.alert[_ngcontent-%COMP%]{padding:10px 16px;border-radius:7px;margin-bottom:10px;font-size:1em;display:flex;align-items:center;gap:8px;animation:_ngcontent-%COMP%_fadeIn .5s}.alert-success[_ngcontent-%COMP%]{background:#e8f5e9;color:var(--success);border:1.5px solid #b2dfdb}.alert-danger[_ngcontent-%COMP%]{background:#ffebee;color:var(--error);border:1.5px solid #ffcdd2}button[type=submit][_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--primary) 60%,var(--primary-light));color:#fff;border:none;border-radius:8px;padding:13px 0;font-size:1.08rem;font-weight:600;letter-spacing:.5px;margin-top:10px;box-shadow:0 2px 8px #1976d21a;cursor:pointer;transition:background .2s,transform .15s,box-shadow .2s;position:relative;overflow:hidden}button[type=submit][_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(90deg,var(--primary-dark) 60%,var(--primary));transform:translateY(-2px) scale(1.03);box-shadow:0 4px 16px #1976d22e}button[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}button[type=submit][_ngcontent-%COMP%]   .fa-spinner[_ngcontent-%COMP%]{margin-right:8px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 600px){.template-create-container[_ngcontent-%COMP%]{padding-top:10px}form[_ngcontent-%COMP%]{min-width:0;max-width:98vw;padding:18px 6vw}}"]})}}return r})();var qn=[{path:"",component:Re,children:[{path:"compte",component:Ge},{path:"admin_eSim/:id",component:Ye},{path:"offre",component:Je},{path:"commande",component:Xe},{path:"console-sync",component:Ze},{path:"destinations",component:et},{path:"esims",component:nt},{path:"console-connect",component:ot},{path:"template-create",component:rt}]}],st=(()=>{class r{static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275mod=me({type:r})}static{this.\u0275inj=ce({imports:[ye.forChild(qn),ye]})}}return r})();var Zi=(()=>{class r{static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275mod=me({type:r})}static{this.\u0275inj=ce({imports:[A,z,st]})}}return r})();export{Zi as AdminModule};
